<!doctype html><!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]--><!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if IE 8]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class=no-js><!--<![endif]--><head><meta charset=utf-8><title>PowerShell &#183; DefinIT</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta property="og:title" content="PowerShell  &#183; DefinIT "><meta property="og:site_name" content="DefinIT"><meta property="og:url" content="https://www.definit.co.uk/tag/powershell/"><meta property="og:locale" content="en-gb"><meta property="og:type" content="website"><link rel=alternate type=application/rss+xml href=https://www.definit.co.uk/tag/powershell/index.xml title=DefinIT><link rel=canonical href=https://www.definit.co.uk/tag/powershell/><link rel=apple-touch-icon-precomposed sizes=144x144 href=/touch-icon-144-precomposed.png><link rel=icon href=/images/favicon-16x16.png><meta name=generator content="Hugo 0.107.0"><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js></script>
<script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><script src=/js/clr-icons.min.js></script>
<script src=/js/custom-elements.min.js></script>
<link href=/css/clr-ui.min.css rel=stylesheet><link href=/css/clr-icons.min.css rel=stylesheet><link href=/css/definit-clarity.css rel=stylesheet><link href=/css/lightbox.min.css rel=stylesheet></head><body id=body data-ng-app=myapp data-ng-controller=MyController data-ng-mouseleave=MouseLeave($event)><clr-main-container class=main-container><header class=header-6><div class=branding><a class=navbar-brand-img href=/><img alt src=/images/logos/definit-logo.png>
<span class=title>DefinIT</span></a></div><nav class=header-nav><a class="nav-link nav-text" href=https://www.definit.co.uk/ title=Home>Home</a>
<a class="nav-link nav-text" href=https://www.definit.co.uk/about/ title=About>About</a>
<a class="nav-link nav-text" href=https://www.github.com/sammcgeown title=GitHub>GitHub</a>
<a class="nav-link nav-text" href=https://www.definit.co.uk/index.xml title=RSS>RSS</a></nav><div class=header-actions><form class=search id=search method=get action=//google.com/search><label for=search_input><input id=search_input type=text name=q placeholder="Search with Google">
<input type=hidden name=as_sitesearch value=https://www.definit.co.uk></label></form></div></header><div class=content-container><div class=content-area><h1>PowerShell</h1><div class=clr-row><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2011/10/vmware-powercli-set-path-selection-policy-on-all-luns-for-a-host/>VMware PowerCLI – Set Path Selection Policy on all LUNs for a host</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 28/10/2011</div><div class=clr-card-authors>Published under <a href=/category/microsoft>Microsoft</a> and <a href=/category/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>Just a quick script to set the Path Selection Policy on any LUNs on a host that do not have your target policy enabled. The script sets the server to Maintenance mode first, evacuating any VMs if you are in a full DRS automated environment. While this is not strictly necessary, it was required for my production environment just to be safe.
param( [string] $vCenterServer = $(Read-Host -prompt "Enter vCenter Server Name"</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2011/10/vmware-powercli-set-path-selection-policy-on-all-luns-for-a-host/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2011/10/scom-2007-dfs-backlog-monitoring-%E2%80%93-distributing-a-runas-account-to-only-dfs-replication-members/>SCOM 2007 DFS Backlog Monitoring – Distributing a RunAs account to only DFS replication members</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 18/10/2011</div><div class=clr-card-authors>Published under</div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>The DFS monitoring tool in SCOM 2007 has some great features, which will replace many a custom VB script running in enterprises. As with a lot of Management Packs, to get the most out of it you need to have a dedicated RunAs account with local admin permissions on the servers you are monitoring (e.g. for the Backlogged Files reporting).
The easy (and wrong) option here is to go with the less secure option and distribute a RunAs account to ALL servers.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2011/10/scom-2007-dfs-backlog-monitoring-%E2%80%93-distributing-a-runas-account-to-only-dfs-replication-members/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2011/03/exchange-2010-createtestuser-mailbox-could-not-be-created-verify-that-ou-users-exists-and-that-password-meets-complexity-requirements/>Exchange 2010 – CreateTestUser : Mailbox could not be created. Verify that OU ( Users ) exists and that password meets complexity requirements</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 21/3/2011</div><div class=clr-card-authors>Published under <a href=/category/microsoft>Microsoft</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>While using the New-TestCasConnectivityUser.ps1 script to create a test user for Exchange 2010’s connectivity testing, I ran into an issue:
CreateTestUser : Mailbox could not be created. Verify that OU ( Users ) exists and that password meets complexity requirements. At C:\Program Files\Microsoft\Exchange Server\V14\Scripts\new-TestCasConnectivityUser.ps1:255 char:27 + $result = CreateTestUser &lt;&lt;&lt;&lt; $exchangeServer $mailboxServer $securePassword $OrganizationalUnit $UMDialPlan $UMExtension $Prompt + CategoryInfo : NotSpecified: (:) [Write-Error], WriteErrorException + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,CreateTestUser Oddly enough, that OU does exist (as it will by default on any Windows Domain!</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2011/03/exchange-2010-createtestuser-mailbox-could-not-be-created-verify-that-ou-users-exists-and-that-password-meets-complexity-requirements/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2011/02/reporting-all-activesync-devices-and-users-in-exchange-2010/>Reporting all ActiveSync devices and their Users in Exchange 2010</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 8/2/2011</div><div class=clr-card-authors>Published under</div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>Recently I needed to report on the ActiveSync devices that were attached to our Exchange 2010 organisation, and which users they were accessing, and then export them to a CSV file.
This is the script:
$ActiveSyncDevices = @() ForEach ($Mailbox in Get-Mailbox –Server MBX01) { Get-ActiveSyncDeviceStatistics -Mailbox $Mailbox.Identity –ErrorAction SilentlyContinue | Select DeviceFriendlyName, Devicetype, DeviceUserAgent | ForEach-Object { $_ | Add-Member –MemberType NoteProperty -Name "MailboxIdentity" -value $Mailbox $ActiveSyncDevices += $_ } } $ActiveSyncDevices | Export-csv c:\Path\To\File.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2011/02/reporting-all-activesync-devices-and-users-in-exchange-2010/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2010/11/using-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions/>Using PowerShell to add IP addresses to IIS7&amp;rsquo;s FTP IPv4 Address and Domain Restrictions</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 24/11/2010</div><div class=clr-card-authors>Published under <a href=/category/microsoft>Microsoft</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>Today I was configuring a new FTP server based on IIS7 (well, 7.5 technically as it’s a Server 2008 R2 host), and I wanted an easy way to add and remove allowed IP addresses based on either an XML config file or a CSV import. Customers’ IP addresses are added or removed regularly, but I didn’t want to have to update their details twice, once on the server and once in the documents.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2010/11/using-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2010/09/creatingenabling-exchange-2010-personal-archives/>Creating/Enabling Exchange 2010 Personal Archives</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 13/9/2010</div><div class=clr-card-authors>Published under <a href=/category/microsoft>Microsoft</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>With the release of Exchange 2010 SP1, administrators can now use separate Mailbox Databases to store the Personal Archives of users – this is particularly useful if you have some larger, slower (and probably by virtue, older) storage that’s not really up to the I/O of your Exchange Server (that old SAN/NAS sitting in the corner of the server room?). It’s also useful if you just don’t have the capacity on your main storage.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2010/09/creatingenabling-exchange-2010-personal-archives/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2010/03/configuring-server-2008-r2-core-series-installing-and-managing-iis/>Configuring Server 2008 R2 Core Series: Installing and Managing IIS</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 24/3/2010</div><div class=clr-card-authors>Published under <a href=/category/microsoft>Microsoft</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>So, you’ve installed a new server with Server 2008 R2 Core – what next? Logging on, you’re presented with a shiny command prompt, you can run notepad or regedit…but aside from that, where do you go from there? In the next few series of posts I’ll hopefully point out the basics, and some not so basics!
In this post, I’m covering Installing the IIS web server (and a few useful bits) and managing it from the IIS Management Snap-in.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2010/03/configuring-server-2008-r2-core-series-installing-and-managing-iis/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2009/01/powershell-script-to-zip-all-bak-files-in-a-folder-structure-then-delete-the-bak/>Powershell script to zip all .bak files in a folder structure, then delete the .bak</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 20/1/2009</div><div class=clr-card-authors>Published under</div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>Our development SQL server is a monster…there are many many databases, and hundreds, if not thousands of backup files. With each patch tested on the software we sell, there is a new backup. With each client deployment, a new database. With each new major version, a new database. Backups of the new databases inevitably occur, and so we have more files, in more folders - most of which need to be kept in case of roll-backs, bugs or deployment issues.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2009/01/powershell-script-to-zip-all-bak-files-in-a-folder-structure-then-delete-the-bak/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2008/09/vista-msu-installer-fails-with-error-installer-encountered-an-error-0x80070422/>Vista .msu installer fails with error: Installer encountered an error: 0×80070422</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 11/9/2008</div><div class=clr-card-authors>Published under</div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>I needed to use PowerShell for something today on my Vista laptop, but was unable to install the file. I had the normal UAC permission required when I ran it, but then it failed with this error
Installer encountered an error: 0x80070422
The service cannot be started, either because it is disabled or because it
has no enabled devices associated with it.
It turns out that you need to enable the Windows Update service in order to use an MSU file.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2008/09/vista-msu-installer-fails-with-error-installer-encountered-an-error-0x80070422/>More</a></div></div></div></div><nav><ul class=pagination><li class="pagination__item pagination__item--first"><a class="btn btn-sm btn btn-outline" href=/tag/powershell/>1</a></li><li class="pagination__item pagination__item--previous"><a href=/tag/powershell/ class="btn btn-sm btn btn-outline">...</a></li><li class=pagination__item><a href=/tag/powershell/ class="btn btn-sm btn btn-outline">1</a></li><li class="pagination__item pagination__item--current"><a href=/tag/powershell/page/2/ class="btn btn-sm btn btn-primary">2</a></li></ul></nav></div><clr-vertical-nav class="clr-vertical-nav has-nav-groups"><div class=nav-content><section class=sidenav-content><a class=nav-link href=/>Home</a>
<clr-vertical-nav-group class=nav-group><div class=nav-group-content><button type=button class=nav-group-trigger aria-expanded=false aria-label="Toggle vertical navigation group" onclick='toggleNavigation("categories")'><div class=nav-group-text>Categories</div><clr-icon shape=angle class=nav-group-trigger-icon id=icon-categories dir=down title=Collapse></clr-icon></button></div><div id=section-categories class=nav-group-children><clr-vertical-nav-group-children><a class=nav-link href=https://www.definit.co.uk/category/career/><span class=nav-text>career <span class="badge badge-1">26</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/cloud-native/><span class=nav-text>cloud-native <span class="badge badge-1">17</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/community/><span class=nav-text>community <span class="badge badge-1">44</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/microsoft/><span class=nav-text>microsoft <span class="badge badge-1">60</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/networking/><span class=nav-text>networking <span class="badge badge-1">29</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/nsx/><span class=nav-text>nsx <span class="badge badge-1">16</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/vcf/><span class=nav-text>vcf <span class="badge badge-1">2</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/vmware/><span class=nav-text>vmware <span class="badge badge-1">206</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/vmware-aria/><span class=nav-text>vmware-aria <span class="badge badge-1">1</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/vmware-multi-cloud/><span class=nav-text>vmware-multi-cloud <span class="badge badge-1">1</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/vrealize-automation/><span class=nav-text>vrealize-automation <span class="badge badge-1">40</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/vrealize-operations/><span class=nav-text>vrealize-operations <span class="badge badge-1">71</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/vrealize-orchestrator/><span class=nav-text>vrealize-orchestrator <span class="badge badge-1">23</span></span></a>
<a class=nav-link href=https://www.definit.co.uk/category/vsphere/><span class=nav-text>vsphere <span class="badge badge-1">56</span></span></a></clr-vertical-nav-group-children></div></clr-vertical-nav-group><div class=nav-divider></div><clr-vertical-nav-group class=nav-group><div class=nav-group-content><button type=button class=nav-group-trigger aria-expanded=false aria-label="Toggle vertical navigation group" onclick='toggleNavigation("tags")'><div class=nav-group-text>Tags (Top 10)</div><clr-icon shape=angle class=nav-group-trigger-icon id=icon-tags dir=down title=Collapse></clr-icon></button></div><div id=section-tags class=nav-group-children><clr-vertical-nav-group-children><a class=nav-link href=/tag/vrops>vrops <span class="badge badge-1">68</span></a>
<a class=nav-link href=/tag/vmware>vmware <span class="badge badge-1">57</span></a>
<a class=nav-link href=/tag/automation>automation <span class="badge badge-1">40</span></a>
<a class=nav-link href=/tag/windows>windows <span class="badge badge-1">38</span></a>
<a class=nav-link href=/tag/vmworld>vmworld <span class="badge badge-1">34</span></a>
<a class=nav-link href=/tag/esx-and-esxi>esx-and-esxi <span class="badge badge-1">33</span></a>
<a class=nav-link href=/tag/vcenter-server>vcenter-server <span class="badge badge-1">33</span></a>
<a class=nav-link href=/tag/nsx>nsx <span class="badge badge-1">32</span></a>
<a class=nav-link href=/tag/vra>vra <span class="badge badge-1">30</span></a>
<a class=nav-link href=/tag/webinar>webinar <span class="badge badge-1">29</span></a></clr-vertical-nav-group-children></div></clr-vertical-nav-group><div class=nav-divider></div></section></div></clr-vertical-nav><script lang=javascript>function toggleNavigation(e){var t=document.getElementById("section-"+e),n=document.getElementById("icon-"+e);t.style.display==="none"?(t.style.display="block",n.dir="down"):(t.style.display="none",n.dir="right")}</script></div><script async src="https://www.googletagmanager.com/gtag/js?id=UA-4368767-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-4368767-1")</script><script src=/js/lightbox-plus-jquery.min.js></script></clr-main-container></body></html>