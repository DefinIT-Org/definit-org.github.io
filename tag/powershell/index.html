<!doctype html><!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]--><!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if IE 8]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class=no-js><!--<![endif]--><head><meta charset=utf-8><title>PowerShell &#183; DefinIT</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta property="og:title" content="PowerShell  &#183; DefinIT "><meta property="og:site_name" content="DefinIT"><meta property="og:url" content="https://www.definit.co.uk/tag/powershell/"><meta property="og:locale" content="en-gb"><meta property="og:type" content="website"><link rel=alternate type=application/rss+xml href=https://www.definit.co.uk/tag/powershell/index.xml title=DefinIT><link rel=canonical href=https://www.definit.co.uk/tag/powershell/><link rel=apple-touch-icon-precomposed sizes=144x144 href=/touch-icon-144-precomposed.png><link rel=icon href=/images/favicon-16x16.png><meta name=generator content="Hugo 0.103.1"><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js></script>
<script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><script src=/js/clr-icons.min.js></script>
<script src=/js/custom-elements.min.js></script>
<link href=/css/clr-ui.min.css rel=stylesheet><link href=/css/clr-icons.min.css rel=stylesheet><link href=/css/definit-clarity.css rel=stylesheet><link href=/css/lightbox.min.css rel=stylesheet></head><body data-ng-app=myapp data-ng-controller=MyController data-ng-mouseleave=MouseLeave($event)><div class=main-container><header class=header-6><div class=branding><a class=navbar-brand-img href=/><img alt src=/images/logos/definit-logo.png>
<span class=title>DefinIT</span></a></div><nav class=header-nav><a class="nav-link nav-text" href=https://www.definit.co.uk/ title=Home>Home</a>
<a class="nav-link nav-text" href=https://www.definit.co.uk/about/ title=About>About</a>
<a class="nav-link nav-text" href=https://www.github.com/sammcgeown title=GitHub>GitHub</a>
<a class="nav-link nav-text" href=https://www.definit.co.uk/index.xml title=RSS>RSS</a></nav><div class=header-actions><form class=search id=search method=get action=//google.com/search><label for=search_input><input id=search_input type=text name=q placeholder="Search with Google">
<input type=hidden name=as_sitesearch value=https://www.definit.co.uk></label></form></div></header><div class=content-container><div class=content-area><h1>PowerShell</h1><div class=clr-row><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2017/06/powershell-deploying-vcenter-high-availability-in-advanced-mode/>PowerShell: Deploying vCenter High Availability in Advanced Mode</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 30/6/2017</div><div class=clr-card-authors>Published under <a href=/category/vmware>VMware</a> and <a href=/category/vsphere>vSphere</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>With the release of vSphere 6.5, VMware upped the game for vCenter High Availability (vCHA) and introduced an active/passive/witness cluster setup to provide a failover cluster for vCenter Server Appliances. The diagram below shows the architecture of the solution.
Deploying vCHA can be done in two modes - &ldquo;Basic&rdquo; and &ldquo;Advanced&rdquo;. You can use Basic mode if the vCenter you want to be HA is managing the hosts it resides on - in this scenario the wizard configures your vCenter and deploys the Passive and Witness nodes for you.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2017/06/powershell-deploying-vcenter-high-availability-in-advanced-mode/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2016/10/installing-net-core-powershell-and-powercli-on-macos-sierra/>Installing .NET core, PowerShell and PowerCLI on macOS Sierra</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 18/10/2016</div><div class=clr-card-authors>Published under <a href=/category/microsoft>Microsoft</a> and <a href=/category/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden><img src=/images/2016/10/powerclicore140x140.jpg class=clr-card-featured-image>
So, this is something I&rsquo;ve been waiting to write up for a while! PowerShell for macOS has been available for a while now, but what a lot of PowerCLI fans have been waiting for is to be able to use PowerCLI direct from their Mac.
Today, amidst all of the noise from VMWorld, PowerCLI Core dropped as a Fling! That means that although it&rsquo;s not ready for production use yet, it is ready to start testing - and I&rsquo;m way more excited than I should be!</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2016/10/installing-net-core-powershell-and-powercli-on-macos-sierra/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2014/12/configuring-a-vrovcac-powershell-host-with-basic-authentication/>Configuring a vRO/vCAC PowerShell host with Basic Authentication</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 23/12/2014</div><div class=clr-card-authors>Published under <a href=/category/vrealize-orchestrator>vRealize Orchestrator</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>To add a Windows Server 2012 R2 PowerShell host using Basic Authentication only, follow these steps.
Ensure that the Windows Firewall service is running (it doesn&rsquo;t matter if the firewall is enabled or disabled, it should always be running! That&rsquo;s a general rule, not just for this).
On the PowerShell host open a command prompt (*NOT* PowerShell console) as administrator and run the quickconfig command - you can re-run it if it&rsquo;s already been run - but make sure it has.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2014/12/configuring-a-vrovcac-powershell-host-with-basic-authentication/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2014/07/configuring-vcenter-orchestrator-vco-with-powershell-over-https-with-kerberos-authentication/>Configuring vCenter Orchestrator (vCO) with PowerShell over HTTPS with Kerberos Authentication</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 23/7/2014</div><div class=clr-card-authors>Published under <a href=/category/vmware>VMware</a> and <a href=/category/vrealize-orchestrator>vRealize Orchestrator</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>As a PowerShell fan I find using the vCO PowerShell plugin makes my life a whole lot easier. What isn&rsquo;t easy however, is the configuration of vCO and a PowerShell jump host. Having done it a few times, this is my method for ensuring a secure working connection using HTTPS and Kerberos.
Configure the Orchestrator Appliance Since we’re planning on using Kerberos authentication, we’d better ensure that the time is correct AND syncs to the same source as the domain.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2014/07/configuring-vcenter-orchestrator-vco-with-powershell-over-https-with-kerberos-authentication/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2014/06/vcenter-5-5-certificate-toolkit-for-distributed-environments/>vCenter 5.5 Certificate Toolkit for Distributed Environments</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 9/6/2014</div><div class=clr-card-authors>Published under <a href=/category/vmware>VMware</a> and <a href=/category/vsphere>vSphere</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>Derek Seaman’s excellent SSL toolkit. I know that there are hours and hours of work put into this script by Derek and I want to thank him for that – it’s a massive time saver. This modification is to fit a different set of circumstances – “standing on the shoulders of giants” – and should in no way be seen as me criticising or stealing Derek’s work.
This week, while using the SSL Certificate Automation Tool and Derek’s script, I encountered a couple of things I felt could be improved for a more complex environment.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2014/06/vcenter-5-5-certificate-toolkit-for-distributed-environments/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2012/11/vcp5-vsphere-5-configuration-maximums-quiz-in-powershell/>VCP5 – vSphere 5 Configuration Maximums Quiz in PowerShell</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 22/11/2012</div><div class=clr-card-authors>Published under <a href=/category/vmware>VMware</a> and <a href=/category/vsphere>vSphere</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>I&rsquo;ve been learning my vSphere 5 config maximums before my upcoming VCP5 exam, so in a supreme effort of procrastination I thought I&rsquo;d write a PowerShell quiz script: here it is!
Save the QuizMe.ps1 file into a folder and then place one or more text file in the same folder containing a comma delimited set of questions and answers. Then run QuizMe.ps1!
You can choose the quiz you take (which text file it will use).</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2012/11/vcp5-vsphere-5-configuration-maximums-quiz-in-powershell/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2012/11/powershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1/>Powershell – Generate Microsoft CA signed SSL certificates with vSphere 5.1</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 6/11/2012</div><div class=clr-card-authors>Published under <a href=/category/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>The process of requesting certificates for vSphere 5.1 is a fairly grim, manual process. It&rsquo;s repetitive and easy to make a mistake on any step of the way. Since I&rsquo;ve got to do this for quite a few VirtualCenter Servers, I thought I&rsquo;d script the certificate generation if nothing else. I am following the excellent documentation provided in Implementing CA signed SSL certificates with vSphere 5.1 and more specifically in Creating certificate requests and certificates for vCenter Server 5.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2012/11/powershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2012/05/scom-2007-r2-daily-health-check-script-v2/>SCOM 2007 R2: Daily Health Check Script v2</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 28/5/2012</div><div class=clr-card-authors>Published under <a href=/category/microsoft>Microsoft</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>A couple of months ago I posted the first version of my SCOM 2007 R2 Daily Health Check Script - here is version 2. It&rsquo;s more than a little motivated by some friendly competition with a Microsoft PFE for SCOM, hopefully you&rsquo;ll agree it&rsquo;s a big improvement on the last version.
Updated for this version
Formatting changed to make it more readable and more compatible Added &ldquo;Report generated on &rdquo; to the top of the report Management Server states reported as one section Default MP check moved to beneath the Management servers Agents in pending states moved to be with the Agent health states Clarified &ldquo;Unresponsive Agents&rdquo; and &ldquo;Agents reporting errors&rdquo; Management server alerts streamlined Added top 10 alerts for the last 7 days, and added top alerters for each I&rsquo;m planning to wrap in some SQL database size checks and some of the other recommendations later - I&rsquo;ll post again here when that&rsquo;s ready 🙂</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2012/05/scom-2007-r2-daily-health-check-script-v2/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2012/02/powershell-recursively-taking-ownership-of-files-and-folders-and-adding-permissions-without-removing-existing-permissions/>PowerShell: Recursively taking ownership of files and folders and adding permissions without removing existing permissions</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 7/2/2012</div><div class=clr-card-authors>Published under <a href=/category/microsoft>Microsoft</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden><img src=/images/2012/02/powershell1.png class=clr-card-featured-image>
This is every file server admin&rsquo;s nightmare: hundreds of shares, thousands of folders, hundreds of thousands of files - and custom or not inherited rights on many of them. Terabytes of data that need auditing - e.g. to find customer data, or credit card information. How do you go about accessing all the data in all the trees? What about backups failing because someone removed the System account? Of course you can seize control of the folder by taking ownership and pushing down from a top level - but how do you preserve the existing Access Control Lists?</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2012/02/powershell-recursively-taking-ownership-of-files-and-folders-and-adding-permissions-without-removing-existing-permissions/>More</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header style=height:74px><a href=https://www.definit.co.uk/2012/01/scom-2007-r2-daily-health-check-script/>SCOM 2007 R2: Daily Health Check Script</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 25/1/2012</div><div class=clr-card-authors>Published under <a href=/category/microsoft>Microsoft</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:200px;min-height:200px;overflow:hidden>An updated version of this script has been released: https://www.definit.co.uk/2012/05/scom-2007-r2-daily-health-check-script-v2/
I&rsquo;ve been working with a Microsft SCOM PFE (Premier Field Engineer) for the last few months and part of the engagement is an environment health check for the SCOM setup. Based on this Microsoft recommend a series of health checks to for the environment that should be carried out every day. This is summarised as the following:
Check the health of all Management Servers and Gateways Check the RMS is not in maintenance mode Review Outstanding Alerts Review Agent&rsquo;s Health Status Review Backup Status Review any Management Group Alerts Review the Pending Management status Review Database Sizes (Operations, Data warehouse, ACS) Review Volume of Alerts Review Alert Latency Document any changes From this, there are certain aspects that can&rsquo;t be automated so easily, or shouldn&rsquo;t be - e.</div></div><div class=card-footer><a class=card-link href=https://www.definit.co.uk/2012/01/scom-2007-r2-daily-health-check-script/>More</a></div></div></div></div><nav><ul class=pagination><li class="pagination__item pagination__item--current"><a href=/tag/powershell/ class="btn btn-sm btn btn-primary">1</a></li><li class=pagination__item><a href=/tag/powershell/page/2/ class="btn btn-sm btn btn-outline">2</a></li><li class="pagination__item pagination__item--next"><a href=/tag/powershell/page/2/ class="btn btn-sm btn-outline">...</a></li><li class="pagination__item pagination__item--last"><a class="btn btn-sm btn btn-outline" href=/tag/powershell/page/2/>2</a></li></ul></nav></div><nav class="sidenav clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><section class=sidenav-content><section class="nav-group collapsible"><input id=Categories type=checkbox>
<label for=Categories>Categories</label><ul class=nav-list><li><a href=/category/career class=nav-link>CAREER <span class="badge badge-1">25</span></a></li><li><a href=/category/cloud-native class=nav-link>CLOUD-NATIVE <span class="badge badge-1">16</span></a></li><li><a href=/category/community class=nav-link>COMMUNITY <span class="badge badge-1">44</span></a></li><li><a href=/category/microsoft class=nav-link>MICROSOFT <span class="badge badge-1">60</span></a></li><li><a href=/category/networking class=nav-link>NETWORKING <span class="badge badge-1">29</span></a></li><li><a href=/category/nsx class=nav-link>NSX <span class="badge badge-1">16</span></a></li><li><a href=/category/vcf class=nav-link>VCF <span class="badge badge-1">2</span></a></li><li><a href=/category/vmware class=nav-link>VMWARE <span class="badge badge-1">206</span></a></li><li><a href=/category/vrealize-automation class=nav-link>VREALIZE-AUTOMATION <span class="badge badge-1">40</span></a></li><li><a href=/category/vrealize-operations class=nav-link>VREALIZE-OPERATIONS <span class="badge badge-1">70</span></a></li><li><a href=/category/vrealize-orchestrator class=nav-link>VREALIZE-ORCHESTRATOR <span class="badge badge-1">23</span></a></li><li><a href=/category/vsphere class=nav-link>VSPHERE <span class="badge badge-1">56</span></a></li></ul></section><section class="nav-group collapsible"><input id=Tags type=checkbox>
<label for=Tags>Tags (Top 10)</label><ul class=nav-list><li><a href=/tag/vrops class=nav-link>VROPS <span class="badge badge-1">68</span></a></li><li><a href=/tag/vmware class=nav-link>VMWARE <span class="badge badge-1">55</span></a></li><li><a href=/tag/automation class=nav-link>AUTOMATION <span class="badge badge-1">40</span></a></li><li><a href=/tag/windows class=nav-link>WINDOWS <span class="badge badge-1">38</span></a></li><li><a href=/tag/vmworld class=nav-link>VMWORLD <span class="badge badge-1">34</span></a></li><li><a href=/tag/esx-and-esxi class=nav-link>ESX-AND-ESXI <span class="badge badge-1">33</span></a></li><li><a href=/tag/vcenter-server class=nav-link>VCENTER-SERVER <span class="badge badge-1">33</span></a></li><li><a href=/tag/nsx class=nav-link>NSX <span class="badge badge-1">32</span></a></li><li><a href=/tag/vra class=nav-link>VRA <span class="badge badge-1">30</span></a></li><li><a href=/tag/webinar class=nav-link>WEBINAR <span class="badge badge-1">29</span></a></li></section></section></nav></div><script async src="https://www.googletagmanager.com/gtag/js?id=UA-4368767-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-4368767-1")</script><script src=/js/lightbox-plus-jquery.min.js></script></div></body></html>