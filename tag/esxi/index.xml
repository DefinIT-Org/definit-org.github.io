<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Esxi on DefinIT</title><link>https://www.definit.co.uk/tag/esxi/</link><description>Recent content in Esxi on DefinIT</description><generator>Hugo</generator><language>en-gb</language><lastBuildDate>Mon, 04 Apr 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://www.definit.co.uk/tag/esxi/index.xml" rel="self" type="application/rss+xml"/><item><title>VCF Host pNIC Change Limitations</title><link>https://www.definit.co.uk/2022/04/vcf-host-pnic-change-limitations/</link><pubDate>Mon, 04 Apr 2022 00:00:00 +0000</pubDate><guid>https://www.definit.co.uk/2022/04/vcf-host-pnic-change-limitations/</guid><description>&lt;p&gt;Recently I stumbled upon a limitation in VCF that isn&amp;rsquo;t very clearly documented, and while not an issue you would regularly come accross. It is an import limitation to be aware of if you plan to adjust your pNIC configuration of any VCF hosts post deployment/commisioning.&lt;/p&gt;
&lt;h2 id="the-problem"&gt;The Problem &lt;a class="anchor" href="#the-problem"&gt;
 &lt;i class="fas fa-hashtag"&gt;&lt;/i&gt;
&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We have a few customers who will not be able to commision their new hosts with the desired pNIC configuration due to current hardware availability. The availability of the pNICs due to global supply challenges has meant severe delays in availability.&lt;/p&gt;</description></item><item><title>VMware Cloud Foundation - Deployment Observations</title><link>https://www.definit.co.uk/2019/07/vmware-cloud-foundation-deployment-observations/</link><pubDate>Mon, 29 Jul 2019 00:00:00 +0000</pubDate><guid>https://www.definit.co.uk/2019/07/vmware-cloud-foundation-deployment-observations/</guid><description>&lt;p&gt;I have been working with VMware Cloud Foundation recently and while for the most part things went well there were occasions where challenges were encountered which made the delivery to the customer all the more trickier than expected.&lt;/p&gt;
&lt;p&gt;This article is a list of observations and things to most definitely check or watch out for when delivering a VCF project.&lt;/p&gt;
&lt;p&gt;We were working with VCF version 3.7.2 (yes I am aware 3.8 has arrived but that was too late for the delivery in this project)&lt;/p&gt;</description></item><item><title>Extending a vCenter Orchestrator (vCO) Workflow with ForEach &amp;ndash; Backing up all ESXi hosts in a Cluster</title><link>https://www.definit.co.uk/2014/03/extending-a-vcenter-orchestrator-vco-workflow-with-foreach-backing-up-all-esxi-hosts-in-a-cluster/</link><pubDate>Thu, 20 Mar 2014 12:38:28 +0000</pubDate><guid>https://www.definit.co.uk/2014/03/extending-a-vcenter-orchestrator-vco-workflow-with-foreach-backing-up-all-esxi-hosts-in-a-cluster/</guid><description>&lt;p&gt;&lt;!-- raw HTML omitted --&gt;In my previous post &lt;a href="https://www.definit.co.uk/?p=4262"&gt;Backing up ESXi 5.5 host configurations with vCenter Orchestrator (vCO) ‚Äì Workflow design walkthrough&lt;/a&gt; I showed how to create a workflow to back up host configurations, but it was limited to one host at a time. For this post I‚Äôm going to show how to create a new workflow that calls the previous one on multiple hosts using a ForEach loop to run it against each one. This was actually easier than I had anticipated (having read posts on previous versions of vCO that involved created the loops manually).&lt;/p&gt;</description></item><item><title>Backing up ESXi 5.5 host configurations with vCenter Orchestrator (vCO) &amp;ndash; Workflow design walkthrough</title><link>https://www.definit.co.uk/2014/03/backing-up-esxi-5-5-host-configurations-with-vcenter-orchestrator-vco-workflow-design-walkthrough/</link><pubDate>Thu, 13 Mar 2014 16:27:19 +0000</pubDate><guid>https://www.definit.co.uk/2014/03/backing-up-esxi-5-5-host-configurations-with-vcenter-orchestrator-vco-workflow-design-walkthrough/</guid><description>&lt;p&gt;&lt;!-- raw HTML omitted --&gt;As a little learning project, I thought I‚Äôd take on &lt;a href="http://vexpert.me/kd"&gt;Simon‚Äôs previous post&lt;/a&gt; about backing up ESXi configurations and extend it to vCenter Orchestrator (vCO), and document how I go about building up a workflow. I&amp;rsquo;m learning more and more about vCO all the time, but I found it has a really steep entry point, and finding use cases is hard if you haven&amp;rsquo;t explored capabilities.&lt;/p&gt;
&lt;p&gt;The steps I want to create in this post are:&lt;/p&gt;</description></item><item><title>Reclaiming an SSD device from ESXi 5.5 Virtual Flash</title><link>https://www.definit.co.uk/2014/02/reclaiming-an-ssd-device-from-esxi-5-5-virtual-flash/</link><pubDate>Thu, 27 Feb 2014 14:02:51 +0000</pubDate><guid>https://www.definit.co.uk/2014/02/reclaiming-an-ssd-device-from-esxi-5-5-virtual-flash/</guid><description>&lt;p&gt;After having a play with Virtual Flash and Host Caching on one of my lab hosts I wanted to re-use the SSD drive, but couldn‚Äôt seem to get vFlash to release the drive. I disabled flash usage on all VMs and disabled the Host Cache, then went to the Virtual Flash Resource Management page to click the ‚ÄúRemove All‚Äù button. That failed with errors:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;‚ÄúHost‚Äôs virtual flash resource is inaccessible.‚Äù&lt;/p&gt;</description></item><item><title>Trouble shooting ‚Äì esx.problem.visorfs.ramdisk.full</title><link>https://www.definit.co.uk/2014/02/trouble-shooting-esx-problem-visorfs-ramdisk-full/</link><pubDate>Tue, 04 Feb 2014 14:47:50 +0000</pubDate><guid>https://www.definit.co.uk/2014/02/trouble-shooting-esx-problem-visorfs-ramdisk-full/</guid><description>&lt;h2 id="problem"&gt;Problem &lt;a class="anchor" href="#problem"&gt;
 &lt;i class="fas fa-hashtag"&gt;&lt;/i&gt;
&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Fairly recently I came across this error message on one of my hosts &amp;ldquo;esx.problem.visorfs.ramdisk.full&amp;rdquo;&lt;/p&gt;
&lt;h2 id="fallout"&gt;Fallout &lt;a class="anchor" href="#fallout"&gt;
 &lt;i class="fas fa-hashtag"&gt;&lt;/i&gt;
&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;While trying to address the issue I had the following problems when the ramdisk did indeed &amp;ldquo;fill up&amp;rdquo;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PSOD (worst case happened only once in my experience)&lt;/li&gt;
&lt;li&gt;VM&amp;rsquo;s struggling to vMotion from the affected host when putting into maintenance mode.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="temporary-workaround"&gt;Temporary workaround &lt;a class="anchor" href="#temporary-workaround"&gt;
 &lt;i class="fas fa-hashtag"&gt;&lt;/i&gt;
&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;A reboot of the host would clear the problem (clear out the ramdisk) for a short while but the problem will return if not addressed properly.&lt;/p&gt;</description></item><item><title>vSphere Security: Advanced SSH Configurations</title><link>https://www.definit.co.uk/2013/10/vsphere-security-advanced-ssh-configurations/</link><pubDate>Tue, 22 Oct 2013 14:26:41 +0000</pubDate><guid>https://www.definit.co.uk/2013/10/vsphere-security-advanced-ssh-configurations/</guid><description>&lt;p&gt;&lt;img src="https://www.definit.co.uk/images/2013/10/Security-Guard_thumb2_thumb.png" alt=""&gt;There are different schools of thought as to whether you should have SSH enabled on your hosts. VMware recommend it is disabled. With SSH disabled there is no possibility of attack, so that‚Äôs the ‚Äúmost secure‚Äù option. Of course in the real world there‚Äôs a balance between ‚Äúmost secure‚Äù and ‚Äúusability‚Äù (e.g. the most secure host is powered off and physically isolated from the network, but you can‚Äôt run any workloads &lt;!-- raw HTML omitted --&gt;). My preferred route is to have it enabled but locked down.&lt;/p&gt;</description></item><item><title>Recover ESXi Root Password using AD Authentication</title><link>https://www.definit.co.uk/2013/10/recover-esxi-root-password-using-ad-authentication/</link><pubDate>Mon, 07 Oct 2013 10:12:08 +0000</pubDate><guid>https://www.definit.co.uk/2013/10/recover-esxi-root-password-using-ad-authentication/</guid><description>&lt;p&gt;&lt;img src="https://www.definit.co.uk/images/2010/11/VMware3.jpg" alt=""&gt;Losing a root password isn‚Äôt something that happens often, but when it does it‚Äôs normally a really irritating time. I have to rotate the password of all hosts once a month for compliance, but sometimes a host drops out of the loop and the root password gets lost. Fortunately, as the vpxuser is still valid I can manage the host via vCenter - this lends itself to this little recovery process:&lt;/p&gt;</description></item><item><title>vSphere Security: Active Directory Authentication</title><link>https://www.definit.co.uk/2013/10/vsphere-security-active-directory-authentication/</link><pubDate>Fri, 04 Oct 2013 15:13:34 +0000</pubDate><guid>https://www.definit.co.uk/2013/10/vsphere-security-active-directory-authentication/</guid><description>&lt;p&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;This is the second article in a series of vSphere Security articles that I have planned. The majority of this article is based on vSphere/ESXi 5.1, though I will include any 5.5 information that I find relevant. The first article in this series was &lt;a href="https://www.definit.co.uk/2013/09/vsphere-security-understanding-esxi-5-x-lockdown-mode/"&gt;vSphere Security: Understanding ESXi 5.x Lockdown Mode&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Why would you want to join an ESXi host to an Active Directory domain? Well you‚Äôre not going to get Group Policies applying, what you‚Äôre really doing is adding another authentication provider directly to the ESXi host. You will see a computer object created in AD, but you will still need to create a DNS entry (or configure DHCP to do it for you). What you will get is a way to audit root access to your hosts, to give administrators a single sign on for managing all aspects of your virtual environment and more options in your administrative arsenal ‚Äì for example, if you‚Äôre using an AD group to manage host root access, you don‚Äôt have to log onto however many ESXi hosts you have to remove a user‚Äôs permissions, simply remove them from the group. You can keep your root passwords in a sealed envelope for emergencies! üòâ&lt;/p&gt;</description></item><item><title>What sort of lab would you build for $2000?</title><link>https://www.definit.co.uk/2013/09/what-sort-of-lab-would-you-build-for-2000/</link><pubDate>Fri, 20 Sep 2013 10:39:06 +0000</pubDate><guid>https://www.definit.co.uk/2013/09/what-sort-of-lab-would-you-build-for-2000/</guid><description>&lt;p&gt;John Troyer (@jtroyer) asked a question on Twitter last night about a CloudCred prize of $1000-2000:&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;¬†&lt;/p&gt;
&lt;p&gt;That got me thinking ‚Äì was it possible to create an entire 2 host lab with storage on a $2000 budget? My first step was to convert it into a proper currency:&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;I figured that I‚Äôd stick to the Intel NUC route that I‚Äôve gone down for &lt;a href="https://www.definit.co.uk/lab/" title="Lab"&gt;my lab&lt;/a&gt; at home ‚Äì I love the NUC for its tiny form factor, silent operation and really low power consumption. There are down sides ‚Äì it can only take 16GB RAM, only one mSATA disk and only has one gigabit NIC. I don‚Äôt think any of those are too big a deal for a personal lab though ‚Äì certainly I‚Äôve not had any problems building and testing VMware products on my single NUC. I‚Äôd drop in an 8GB stick of RAM and an Intel 60GB mSATA SSD per NUC ‚Äì you could always go 16GB later by adding another 8GB stick in the 2nd slot. I picked the Intel mSATA disk for it‚Äôs controller and throughput figures ‚Äì there are larger and cheaper ones but not with the same write performance. Since the use of SSD is massively in focus with vFlash, PernixData FVP and several other technologies, you wouldn‚Äôt want to miss out. I‚Äôve also added an 8GB USB3 flash drive per NUC to boot ESXi from.&lt;/p&gt;</description></item><item><title>Installing and Configuring vCenter Log Insight</title><link>https://www.definit.co.uk/2013/06/installing-and-configuring-vcenter-log-insight/</link><pubDate>Wed, 12 Jun 2013 13:32:26 +0000</pubDate><guid>https://www.definit.co.uk/2013/06/installing-and-configuring-vcenter-log-insight/</guid><description>&lt;p&gt;&lt;!-- raw HTML omitted --&gt;With the release of vCenter Log Insight Public Beta (&lt;a href="http://communities.vmware.com/community/vmtn/vcenter/vcenter-log-insight" title="http://communities.vmware.com/community/vmtn/vcenter/vcenter-log-insight"&gt;http://communities.vmware.com/community/vmtn/vcenter/vcenter-log-insight&lt;/a&gt;) I thought I‚Äôd strike while the iron is hot and run through the installation and configuration.&lt;/p&gt;
&lt;h2 id="deploying-the-ovf"&gt;Deploying the OVF &lt;a class="anchor" href="#deploying-the-ovf"&gt;
 &lt;i class="fas fa-hashtag"&gt;&lt;/i&gt;
&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;This is such a bread and butter task that it doesn‚Äôt require more than a few words ‚Äì it‚Äôs definitely worth looking at the Sizing PDF before you deploy (&lt;a href="http://communities.vmware.com/servlet/JiveServlet/downloadBody/23714-102-1-31648/VMware-vCenter-Log-Insight-1.0-Beta-Virtual-Appliance-Sizing.pdf"&gt;VMware-vCenter-Log-Insight-1.0-Beta-Virtual-Appliance-Sizing.pdf&lt;/a&gt;) as it‚Äôs not small even for a test installation. If you‚Äôre using less than the recommended 8GB RAM there are additional steps to change the heap size for performance.&lt;/p&gt;</description></item><item><title>Installing VMware vSphere Update Manager Download Service and publishing via IIS</title><link>https://www.definit.co.uk/2013/06/installing-vmware-vsphere-update-manager-download-service-and-publishing-via-iis/</link><pubDate>Tue, 11 Jun 2013 15:30:49 +0000</pubDate><guid>https://www.definit.co.uk/2013/06/installing-vmware-vsphere-update-manager-download-service-and-publishing-via-iis/</guid><description>&lt;p&gt;The vSphere UMDS provides a way to download patches for VMware servers that have an air-gap, or for some reason aren‚Äôt allowed to go out to the internet themselves ‚Äì in my case a security policy prevented a DMZ vCenter Server from connecting to the internet directly. The solution is to use UMDS to download the updates to a 2nd server that was hosted in the DMZ and then update the vCenter Server from there. It also can save on bandwidth if you‚Äôre running multiple vCenter Servers, which again was the case (though bandwidth isn‚Äôt really a constraint).&lt;/p&gt;</description></item><item><title>DataStore conflicts with an existing DataStore in the DataCenter ‚Äì Manually disabling Storage I/O Control</title><link>https://www.definit.co.uk/2012/10/datastore-conflicts-with-an-existing-datastore-in-the-datacenter-manually-disabling-storage-io-control/</link><pubDate>Wed, 17 Oct 2012 15:31:01 +0000</pubDate><guid>https://www.definit.co.uk/2012/10/datastore-conflicts-with-an-existing-datastore-in-the-datacenter-manually-disabling-storage-io-control/</guid><description>&lt;p&gt;&lt;img src="https://www.definit.co.uk/images/2010/11/VMware3.jpg" alt=""&gt;I ran into this issue yesterday while reconnecting hosts in our vCenter Server following a complete reinstall - the reasons for which are a long story, but suffice to say that there were new certificates and the host passwords were encrypted with the old ones.&lt;/p&gt;
&lt;p&gt;The LUNs had been unpresented at the hardware level by the storage team, but had not been unmounted or removed from vCenter. This is &lt;em&gt;&lt;strong&gt;not&lt;/strong&gt;&lt;/em&gt; the way to remove storage - let me re-iterate: &lt;a href="http://blogs.vmware.com/vsphere/2011/11/best-practice-how-to-correctly-remove-a-lun-from-an-esx-host.html"&gt;remove storage properly&lt;/a&gt;. Unfortunately in this case the storage was removed badly¬†- doing this¬†can lead to a condition called &amp;ldquo;All Paths Down&amp;rdquo; or APD which is best explained by Cormac Hogan (@vmwarestorage) in the article &lt;a href="http://blogs.vmware.com/vsphere/2011/08/all-path-down-apd-handling-in-50.html"&gt;Handling the All Paths Down (APD) condition&lt;/a&gt;.&lt;/p&gt;</description></item><item><title>VMware ESXi Maximum paths includes local storage</title><link>https://www.definit.co.uk/2012/08/vmware-esxi-maximum-paths-includes-local-storage/</link><pubDate>Mon, 20 Aug 2012 09:45:16 +0000</pubDate><guid>https://www.definit.co.uk/2012/08/vmware-esxi-maximum-paths-includes-local-storage/</guid><description>&lt;p&gt;&lt;img src="https://www.definit.co.uk/images/2010/11/VMware3.jpg" alt=""&gt;If you are close to the VMware ESXi storage path limit of 1024 paths per host, you may want to consider the following: &lt;strong&gt;local storage, including CD-ROMs, are counted in your total paths&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Simply because of the size and age¬†of the environment, some of our production clusters have now reached the limit (including local paths) - you see this message in the logs&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[2012-08-20 01:48:52.256 77C3DB90 info &amp;lsquo;ha-eventmgr&amp;rsquo;] Event 2003 : The maximum number of supported paths of 1024 has been reached. Path vmhba3:C0:T4:L0 could not be added.&lt;/p&gt;</description></item><item><title>The case of the missing network adaptor: a.k.a Installing additional drivers on ESXi 4.1</title><link>https://www.definit.co.uk/2011/03/the-case-of-the-missing-network-adaptor-a-k-a-installing-additional-drivers-on-esxi-4-1/</link><pubDate>Thu, 03 Mar 2011 14:15:17 +0000</pubDate><guid>https://www.definit.co.uk/2011/03/the-case-of-the-missing-network-adaptor-a-k-a-installing-additional-drivers-on-esxi-4-1/</guid><description>&lt;p&gt;&lt;!-- raw HTML omitted --&gt;Recently I installed and configured a client‚Äôs new ESXi host, they‚Äôre a small company and only require a single host. The host in question was an IBM x3650 M3, an excellent workhorse for virtualisation and one of 5 or 6 of the same model that I‚Äôve installed in the last year. In addition to the onboard Broadcom Dual Gigabit NIC, we always install at least a second Intel PCIx Dual Gigabit card for resilience/redundancy/performance.&lt;/p&gt;</description></item><item><title>Configuring Software iSCSI multipathing on ESXi 4.1</title><link>https://www.definit.co.uk/2010/11/configuring-software-iscsi-multipathing-on-esxi-4-1/</link><pubDate>Fri, 12 Nov 2010 16:40:28 +0000</pubDate><guid>https://www.definit.co.uk/2010/11/configuring-software-iscsi-multipathing-on-esxi-4-1/</guid><description>&lt;p&gt;&lt;img src="https://www.definit.co.uk/images/2010/11/VMware3.jpg" alt=""&gt;Recently I had cause to configure iSCSI multipathing on a test ESXi server. The production environment servers use iSCSI HBAs to connect to the back end storage, so multipathing them is a straight-forward setup.&lt;/p&gt;
&lt;p&gt;It‚Äôs good practice to separate VMotion, virtual machine and iSCSI traffic, it also helps you manage those logical and physical connections.&lt;/p&gt;
&lt;p&gt;Connect to your ESXi server using the vSphere Client and select the host. Go to the configuration tab and click ‚ÄúAdd Networking‚Ä¶‚Äù. Select a new VMKernel connection type.&lt;/p&gt;</description></item><item><title>Managing ESXi 4.1 with vMA 4.1 on VMware Workstation</title><link>https://www.definit.co.uk/2010/10/managing-esxi-4-1-with-vma-4-1-on-vmware-workstation/</link><pubDate>Thu, 21 Oct 2010 21:12:00 +0000</pubDate><guid>https://www.definit.co.uk/2010/10/managing-esxi-4-1-with-vma-4-1-on-vmware-workstation/</guid><description>&lt;p&gt;vMA is available as a Virtual Appliance (OVF) from VMware. To install it on VMware Workstation 7, open Workstation and select Import or Export to import a new OVF, the URL for the latest OVF for vMA is on the &lt;!-- raw HTML omitted --&gt;vMA download page&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://www.definit.co.uk/images/2010/10/image_thumb.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;As &lt;!-- raw HTML omitted --&gt;per this article on virtualkenneth.com&lt;!-- raw HTML omitted --&gt;, you need to edit the VMX file to change the SCSI card and OS type, otherwise you‚Äôll have a kernel panic on boot.&lt;/p&gt;</description></item></channel></rss>