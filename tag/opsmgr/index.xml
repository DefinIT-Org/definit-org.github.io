<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Opsmgr on DefinIT</title><link>https://www.definit.co.uk/tag/opsmgr/</link><description>Recent content in Opsmgr on DefinIT</description><generator>Hugo</generator><language>en-gb</language><lastBuildDate>Mon, 28 May 2012 13:57:02 +0000</lastBuildDate><atom:link href="https://www.definit.co.uk/tag/opsmgr/index.xml" rel="self" type="application/rss+xml"/><item><title>SCOM 2007 R2: Daily Health Check Script v2</title><link>https://www.definit.co.uk/2012/05/scom-2007-r2-daily-health-check-script-v2/</link><pubDate>Mon, 28 May 2012 13:57:02 +0000</pubDate><guid>https://www.definit.co.uk/2012/05/scom-2007-r2-daily-health-check-script-v2/</guid><description>&lt;p&gt;&lt;!-- raw HTML omitted --&gt;A couple of months ago¬†I posted the first version of my &lt;a href="http://bit.ly/x9qwg4" target="_blank"&gt;
 &lt;clr-icon shape="pop-out" size="12"&gt;&lt;/clr-icon&gt; SCOM 2007 R2 Daily Health Check Script
&lt;/a&gt; - here is version 2. It&amp;rsquo;s more than a little motivated by some friendly competition with a Microsoft PFE for SCOM, hopefully you&amp;rsquo;ll agree it&amp;rsquo;s a big improvement on the last version.&lt;/p&gt;
&lt;p&gt;Updated for this version&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Formatting changed to make it more readable and more compatible&lt;/li&gt;
&lt;li&gt;Added &amp;ldquo;Report generated on &lt;em&gt;&lt;!-- raw HTML omitted --&gt;&lt;/em&gt;&amp;rdquo; to the top of the report&lt;/li&gt;
&lt;li&gt;Management Server states reported as one section&lt;/li&gt;
&lt;li&gt;Default MP check moved to beneath¬†the Management servers&lt;/li&gt;
&lt;li&gt;Agents in pending states moved to be with the Agent health states&lt;/li&gt;
&lt;li&gt;Clarified &amp;ldquo;Unresponsive Agents&amp;rdquo; and &amp;ldquo;Agents reporting errors&amp;rdquo;&lt;/li&gt;
&lt;li&gt;Management server alerts streamlined&lt;/li&gt;
&lt;li&gt;Added top 10 alerts for the last 7 days, and added top alerters for each&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I&amp;rsquo;m planning to wrap in some SQL database size checks and some of the other recommendations later - I&amp;rsquo;ll post again here when that&amp;rsquo;s ready üôÇ&lt;/p&gt;</description></item><item><title>SCOM 2007 R2: Daily Health Check Script</title><link>https://www.definit.co.uk/2012/01/scom-2007-r2-daily-health-check-script/</link><pubDate>Wed, 25 Jan 2012 16:59:39 +0000</pubDate><guid>https://www.definit.co.uk/2012/01/scom-2007-r2-daily-health-check-script/</guid><description>&lt;p&gt;An updated version of this script has been released: &lt;a href="https://www.definit.co.uk/2012/05/scom-2007-r2-daily-health-check-script-v2/" target="_blank"&gt;
 &lt;clr-icon shape="pop-out" size="12"&gt;&lt;/clr-icon&gt; https://www.definit.co.uk/2012/05/scom-2007-r2-daily-health-check-script-v2/
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://www.definit.co.uk/images/2011/01/MSFT-System-Center-logo_thumb.png" alt=""&gt;I&amp;rsquo;ve been working with a Microsft SCOM PFE (Premier Field Engineer) for the last few months and part of the engagement is an environment health check for the SCOM setup. Based on this Microsoft recommend a series of health checks to for the environment that should be carried out every day. This is summarised as the following:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Check the health of all Management Servers and Gateways&lt;/li&gt;
&lt;li&gt;Check the RMS is not in maintenance mode&lt;/li&gt;
&lt;li&gt;Review Outstanding Alerts&lt;/li&gt;
&lt;li&gt;Review Agent&amp;rsquo;s Health Status&lt;/li&gt;
&lt;li&gt;Review Backup Status&lt;/li&gt;
&lt;li&gt;Review any Management Group Alerts&lt;/li&gt;
&lt;li&gt;Review the Pending Management status&lt;/li&gt;
&lt;li&gt;Review Database Sizes (Operations, Data warehouse, ACS)&lt;/li&gt;
&lt;li&gt;Review Volume of Alerts&lt;/li&gt;
&lt;li&gt;Review Alert Latency&lt;/li&gt;
&lt;li&gt;Document any changes¬†&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;From this, there are certain aspects that can&amp;rsquo;t be automated so easily, or¬†shouldn&amp;rsquo;t be¬†- e.g:&lt;/p&gt;</description></item><item><title>Overriding the OpsMgr Exchange 2007 Test MAPI Connectivity Monitor for Recovery Storage Groups</title><link>https://www.definit.co.uk/2012/01/overriding-the-opsmgr-exchange-2007-test-mapi-connectivity-monitor-for-recovery-storage-groups/</link><pubDate>Thu, 05 Jan 2012 12:29:27 +0000</pubDate><guid>https://www.definit.co.uk/2012/01/overriding-the-opsmgr-exchange-2007-test-mapi-connectivity-monitor-for-recovery-storage-groups/</guid><description>&lt;p&gt;&lt;img src="https://www.definit.co.uk/images/2011/01/MSFT-System-Center-logo_thumb.png" alt=""&gt;The Test MAPI Connectivity monitor for the Exchange 2007 management pack will automatically generate a critical error for any Recovery Storage Groups you have on monitored Exchange Mailbox Roles. As these are generally temporary Storage Groups created for a recovery and then removed, you don&amp;rsquo;t want an alert - but manually adding an override for every time is not a great use of your time either.&lt;/p&gt;
&lt;p&gt;The State Change event details are as follows:&lt;/p&gt;</description></item><item><title>Trouble with SCOM 2007 R2 Certificates? Validate the entire PKI path!</title><link>https://www.definit.co.uk/2012/01/troublewithscom2007r2certificates/</link><pubDate>Thu, 05 Jan 2012 11:30:23 +0000</pubDate><guid>https://www.definit.co.uk/2012/01/troublewithscom2007r2certificates/</guid><description>&lt;p&gt;&lt;img src="https://www.definit.co.uk/images/2011/01/MSFT-System-Center-logo_thumb.png" alt=""&gt;I learned something new today: SCOM 2007 R2 certificate based communications not only checks the validity of the certificate you use, but also the CA that issued it‚Ä¶let me expand:&lt;/p&gt;
&lt;p&gt;Like many organisations there is a root CA (we&amp;rsquo;ll call it ROOTCA01), and then a subordinate CA (we&amp;rsquo;ll call that SUBCA01). OPSMGM01 has a certificate to identify itself and has certificates for ROOTCA01 and SUBCA01 in it&amp;rsquo;s Trusted Root Certificate Authorities.&lt;/p&gt;</description></item><item><title>SCOM 2007 DFS Backlog Monitoring ‚Äì Distributing a RunAs account to only DFS replication members</title><link>https://www.definit.co.uk/2011/10/scom-2007-dfs-backlog-monitoring-%E2%80%93-distributing-a-runas-account-to-only-dfs-replication-members/</link><pubDate>Tue, 18 Oct 2011 11:13:25 +0000</pubDate><guid>https://www.definit.co.uk/2011/10/scom-2007-dfs-backlog-monitoring-%E2%80%93-distributing-a-runas-account-to-only-dfs-replication-members/</guid><description>&lt;p&gt;The DFS monitoring tool in SCOM 2007 has some great features, which will replace many a custom VB script running in enterprises. As with a lot of Management Packs, to get the most out of¬†it you need to have a dedicated RunAs account with local admin permissions on¬†the servers you are monitoring (e.g.¬†for the Backlogged Files reporting).&lt;/p&gt;
&lt;p&gt;The easy (and wrong) option here is to go with the less secure option and distribute a RunAs account to ALL servers. There are lots of reasons why you wouldn‚Äôt want to distribute the credentials to &lt;em&gt;every&lt;/em&gt; server in your SCOM installation ‚Äì but just from a security standpoint, you shouldn‚Äôt do it! Selecting the ‚ÄúMore Secure‚Äù option and distributing credentials only to servers which will require them is a much safer bet.&lt;/p&gt;</description></item><item><title>Remote Installation of SCOM 2007 R2 Agent on Threat Management Gateway Servers</title><link>https://www.definit.co.uk/2011/01/remote-installation-of-scom-2007-r2-agent-on-threat-management-gateway-servers/</link><pubDate>Thu, 06 Jan 2011 16:23:51 +0000</pubDate><guid>https://www.definit.co.uk/2011/01/remote-installation-of-scom-2007-r2-agent-on-threat-management-gateway-servers/</guid><description>&lt;p&gt;&lt;img src="https://www.definit.co.uk/images/2011/01/MSFT-System-Center-logo_thumb.png" alt=""&gt;Getting a SCOM 2007 R2 SCOM agent on TMG is a useful way of monitoring TMG, especially with the SCOM TMG Management Pack ‚Äì it‚Äôs not exactly ‚Äúout-of-the-box‚Äù functionality though, with many sources I‚Äôve read simply stating that it can‚Äôt be done. There are some half-working solutions I‚Äôve seen, but nothing that worked for me.&lt;/p&gt;
&lt;p&gt;The process involves simply opening the correct ports and protocols between the TMG servers and the SCOM management servers, which after a few attempts watching the live logs, I found.&lt;/p&gt;</description></item><item><title>Using System Center Operations Manager 2007 R2 Audit Collection Services for remote, DMZ or workgroup servers</title><link>https://www.definit.co.uk/2010/12/using-system-centre-operations-manager-2007-r2-audit-collection-service-for-remote-dmz-or-workgroup-servers/</link><pubDate>Mon, 13 Dec 2010 16:46:07 +0000</pubDate><guid>https://www.definit.co.uk/2010/12/using-system-centre-operations-manager-2007-r2-audit-collection-service-for-remote-dmz-or-workgroup-servers/</guid><description>&lt;p&gt;&lt;img src="https://www.definit.co.uk/images/2010/12/MSFT-System-Center-logo_thumb.png" alt=""&gt;SCOM 2007 R2‚Äôs Audit Collection Services (ACS from now on) is very useful for meeting compliance (e.g. Sarbanes Oxley) and security audit requirements ‚Äì working with financial companies often requires such compliance. It‚Äôs pretty simple to install in a domain environment ‚Äì you run the installer to create a collection server, then activate the forwarder on the client servers.&lt;/p&gt;
&lt;p&gt;When it comes to servers you really want to audit, those that are by definition more at risk from security breach because they are publicly accessible, it‚Äôs not so straightforward. Take for example that web server, or FTP host in your DMZ, certainly not domain joined and probably bombarded by daily brute force password attacks. Select the SCOM agent in the console and enable Audit Collection Services?&lt;/p&gt;</description></item><item><title>Installing System Center Operations Manager 2007 R2 CU2</title><link>https://www.definit.co.uk/2010/09/installing-system-center-operations-manager-2007-r2-cu2/</link><pubDate>Wed, 08 Sep 2010 15:28:04 +0000</pubDate><guid>https://www.definit.co.uk/2010/09/installing-system-center-operations-manager-2007-r2-cu2/</guid><description>&lt;p&gt;&lt;img src="https://www.definit.co.uk/images/2010/09/MSFTSystemCenterlogo_thumb1.png" alt=""&gt; This should be a simple update of some hotfixes, but there were a few tripping points along the way that I had to stumble past. As reference I used the &lt;!-- raw HTML omitted --&gt;CU2 update page&lt;!-- raw HTML omitted --&gt; and I also a &lt;!-- raw HTML omitted --&gt;Kevin Holman technet article&lt;!-- raw HTML omitted --&gt;.&lt;/p&gt;
&lt;p&gt;So, I‚Äôm going to assume that a) you‚Äôre installing the update for a reason, like one of the bugs it fixes and b) you have taken a backup of your OpsManager databases.&lt;/p&gt;</description></item><item><title>Requesting SCOM 2007 Gateway or Agent Certificates for Server 2008 from a Server 2003 Enterprise Certificate Authority</title><link>https://www.definit.co.uk/2010/06/requesting-scom-2007-gateway-or-agent-certificates-for-server-2008-from-a-server-2003-enterprise-certificate-authority/</link><pubDate>Fri, 25 Jun 2010 12:27:33 +0000</pubDate><guid>https://www.definit.co.uk/2010/06/requesting-scom-2007-gateway-or-agent-certificates-for-server-2008-from-a-server-2003-enterprise-certificate-authority/</guid><description>&lt;p&gt;This is a pretty specific set of instructions for a specific environment:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;If&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;you are using Microsoft System Center Operations Manager 2007&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;you have a Microsoft Certificate Services 2003 Certificate Authority on your domain&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;you have non-domain Windows Server 2008 servers you wish to monitor or set up as a gateway server.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;¬†&lt;/p&gt;
&lt;p&gt;Getting a certificate for either a Gateway Server or remotely monitored Server can be a touch vexing. If you‚Äôre installing on the same domain as the SCOM management server the security settings take care of themselves, not so for non-domain servers, which require mutual certificate authentication. The Gateway must trust the Domain CA and identify itself as trusted to the Management Server. I have bashed my head against this several times now, so I thought I‚Äôd make a precise blog post to cover the steps required!&lt;/p&gt;</description></item><item><title>Certificate errors when connecting Gateway Server or non-domain Agent to System Center Operations Manager 2007 R2</title><link>https://www.definit.co.uk/2010/05/certificate-errors-when-connecting-gateway-server-or-non-domain-agent-to-system-center-operations-manager-2007-r2/</link><pubDate>Fri, 07 May 2010 12:56:47 +0000</pubDate><guid>https://www.definit.co.uk/2010/05/certificate-errors-when-connecting-gateway-server-or-non-domain-agent-to-system-center-operations-manager-2007-r2/</guid><description>&lt;p&gt;This was a bit of an odd one. I was adding a Gateway Server to a newly rebuilt SCOM 2007 R2 Root Management Server when I kept encountering this error:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The certificate specified in the registry at HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft Operations Manager\3.0\Machine Settings cannot be used for authentication.¬† The error is The credentials supplied to the package were not recognized(0x8009030D).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I followed the Microsoft install and setup guides exactly, and it‚Äôs not my first time either ‚Äì but I‚Äôd never seen that one before.&lt;/p&gt;</description></item></channel></rss>