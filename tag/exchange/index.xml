<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Exchange on DefinIT</title><link>https://www.definit.co.uk/tag/exchange/</link><description>Recent content in Exchange on DefinIT</description><generator>Hugo -- gohugo.io</generator><language>en-gb</language><lastBuildDate>Thu, 05 Jan 2012 12:29:27 +0000</lastBuildDate><atom:link href="https://www.definit.co.uk/tag/exchange/index.xml" rel="self" type="application/rss+xml"/><item><title>Overriding the OpsMgr Exchange 2007 Test MAPI Connectivity Monitor for Recovery Storage Groups</title><link>https://www.definit.co.uk/2012/01/overriding-the-opsmgr-exchange-2007-test-mapi-connectivity-monitor-for-recovery-storage-groups/</link><pubDate>Thu, 05 Jan 2012 12:29:27 +0000</pubDate><guid>https://www.definit.co.uk/2012/01/overriding-the-opsmgr-exchange-2007-test-mapi-connectivity-monitor-for-recovery-storage-groups/</guid><description>The Test MAPI Connectivity monitor for the Exchange 2007 management pack will automatically generate a critical error for any Recovery Storage Groups you have on monitored Exchange Mailbox Roles. As these are generally temporary Storage Groups created for a recovery and then removed, you don&amp;rsquo;t want an alert - but manually adding an override for every time is not a great use of your time either.
The State Change event details are as follows:</description></item><item><title>Online Archiving with Exchange 2010? Can&amp;rsquo;t see your Online Archive in Outlook?</title><link>https://www.definit.co.uk/2011/03/online-archiving-with-exchange-2010-cant-see-your-online-archive-in-outlook/</link><pubDate>Tue, 22 Mar 2011 12:37:18 +0000</pubDate><guid>https://www.definit.co.uk/2011/03/online-archiving-with-exchange-2010-cant-see-your-online-archive-in-outlook/</guid><description>Having recently managed several Exchange 2010 migration projects, one of the best new features which really sells it to systems administrators is the Online Archive. “No more managing PST files? When can we have it installed by?”
The problem is, once they’ve purchased licensing for Exchange 2010 and installed and configured the server, migrated the users’ mailboxes and decommissioned the old Exchange 2003 server, the Online Archive feature is not available.</description></item><item><title>Exchange 2010 – CreateTestUser : Mailbox could not be created. Verify that OU ( Users ) exists and that password meets complexity requirements</title><link>https://www.definit.co.uk/2011/03/exchange-2010-createtestuser-mailbox-could-not-be-created-verify-that-ou-users-exists-and-that-password-meets-complexity-requirements/</link><pubDate>Mon, 21 Mar 2011 14:56:39 +0000</pubDate><guid>https://www.definit.co.uk/2011/03/exchange-2010-createtestuser-mailbox-could-not-be-created-verify-that-ou-users-exists-and-that-password-meets-complexity-requirements/</guid><description>While using the New-TestCasConnectivityUser.ps1 script to create a test user for Exchange 2010’s connectivity testing, I ran into an issue:
CreateTestUser : Mailbox could not be created. Verify that OU ( Users ) exists and that password meets complexity requirements. At C:\Program Files\Microsoft\Exchange Server\V14\Scripts\new-TestCasConnectivityUser.ps1:255 char:27 + $result = CreateTestUser &amp;lt;&amp;lt;&amp;lt;&amp;lt; $exchangeServer $mailboxServer $securePassword $OrganizationalUnit $UMDialPlan $UMExtension $Prompt + CategoryInfo : NotSpecified: (:) [Write-Error], WriteErrorException + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,CreateTestUser Oddly enough, that OU does exist (as it will by default on any Windows Domain!</description></item><item><title>Reporting all ActiveSync devices and their Users in Exchange 2010</title><link>https://www.definit.co.uk/2011/02/reporting-all-activesync-devices-and-users-in-exchange-2010/</link><pubDate>Tue, 08 Feb 2011 14:28:14 +0000</pubDate><guid>https://www.definit.co.uk/2011/02/reporting-all-activesync-devices-and-users-in-exchange-2010/</guid><description>Recently I needed to report on the ActiveSync devices that were attached to our Exchange 2010 organisation, and which users they were accessing, and then export them to a CSV file.
This is the script:
$ActiveSyncDevices = @() ForEach ($Mailbox in Get-Mailbox –Server MBX01) { Get-ActiveSyncDeviceStatistics -Mailbox $Mailbox.Identity –ErrorAction SilentlyContinue | Select DeviceFriendlyName, Devicetype, DeviceUserAgent | ForEach-Object { $_ | Add-Member –MemberType NoteProperty -Name "MailboxIdentity" -value $Mailbox $ActiveSyncDevices += $_ } } $ActiveSyncDevices | Export-csv c:\Path\To\File.</description></item><item><title>Creating/Enabling Exchange 2010 Personal Archives</title><link>https://www.definit.co.uk/2010/09/creatingenabling-exchange-2010-personal-archives/</link><pubDate>Mon, 13 Sep 2010 13:32:19 +0000</pubDate><guid>https://www.definit.co.uk/2010/09/creatingenabling-exchange-2010-personal-archives/</guid><description>With the release of Exchange 2010 SP1, administrators can now use separate Mailbox Databases to store the Personal Archives of users – this is particularly useful if you have some larger, slower (and probably by virtue, older) storage that’s not really up to the I/O of your Exchange Server (that old SAN/NAS sitting in the corner of the server room?). It’s also useful if you just don’t have the capacity on your main storage.</description></item><item><title>Installing Exchange 2010 SP1</title><link>https://www.definit.co.uk/2010/09/installing-exchange-2010-sp1/</link><pubDate>Thu, 09 Sep 2010 11:23:30 +0000</pubDate><guid>https://www.definit.co.uk/2010/09/installing-exchange-2010-sp1/</guid><description>Exchange SP1 has now been released, so I thought I’d document the upgrade process for my small Exchange 2010 organisation, consisting of one CAS/Transport/Mailbox server, and an Edge Transport server.
References The starting point is always working out if you *need* to upgrade – what’s the business argument. For that you need to look at what’s new in Exchange 2010 SP1, the release notes and prerequisites. Finally, the installation instructions for upgrading from Exchange 2010 RTM to SP1.</description></item><item><title>Installing Exchange 2010 Edge Server with Forefront Protection for Exchange (FPE) and Threat Management Gateway (TMG) – Part 1</title><link>https://www.definit.co.uk/2010/08/installing-exchange-2010-edge-server-with-forefront-protection-for-exchange-fpe-and-threat-management-gateway-tmg-part-1/</link><pubDate>Tue, 10 Aug 2010 13:59:24 +0000</pubDate><guid>https://www.definit.co.uk/2010/08/installing-exchange-2010-edge-server-with-forefront-protection-for-exchange-fpe-and-threat-management-gateway-tmg-part-1/</guid><description>I am mid-migration, in a co-existence setup with Exchange 2010, 2007 and 2003. So far the roles installed for Exchange 2010 are CAS, Hub and Mailbox on a single server. Into this mix I need to introduce an Edge Server, with message hygiene in the form of Forefront Protection for Exchange (FPE) and Threat Management Gateway (TMG) as a reverse proxy to publish OWA, ActiveSync et-al.
Since Edge, FPE and TMG can now all exist on a single 64-bit server, I will start with a clean installation of Windows Server 2008 R2, up to date with all the latest hot fixes.</description></item><item><title>Unable to access Outlook Web Access (OWA) after installing Update Rollup 1, 2, 3 or 4 – flogon.js errors</title><link>https://www.definit.co.uk/2010/08/unable-to-access-outlook-web-access-owa-after-installing-update-rollup-1-2-3-or-4-flogon-js-errors/</link><pubDate>Tue, 10 Aug 2010 11:02:55 +0000</pubDate><guid>https://www.definit.co.uk/2010/08/unable-to-access-outlook-web-access-owa-after-installing-update-rollup-1-2-3-or-4-flogon-js-errors/</guid><description>If you’re having trouble accessing OWA after updating Exchange 2010 with any of the Rollup packages, try this:
Uninstall the update package from the Programs and Features control panel
Download the package file directly from Microsoft, don’t use Windows Update
Open a command prompt or PowerShell prompt as Administrator
Navigate to the location of the package (.msp) and run from the elevated command prompt.
Apparently when Windows update installs the package it doesn’t run it with the elevated privileges to write to the folder in the Exchange program files – why, I have no idea!</description></item><item><title>Passed Microsoft Exams 70-662 and 70-663 – Now officially MCITP: Enterprise Messaging Administrator</title><link>https://www.definit.co.uk/2010/07/passed-microsoft-exams-70-662-and-70-663-now-officially-mcitp-enterprise-messaging-administrator/</link><pubDate>Thu, 29 Jul 2010 09:49:04 +0000</pubDate><guid>https://www.definit.co.uk/2010/07/passed-microsoft-exams-70-662-and-70-663-now-officially-mcitp-enterprise-messaging-administrator/</guid><description>On Monday I took the two Exchange 2010 exams, “70-662 TS: Microsoft Exchange Server 2010, Configuring” and “70-663 PRO: Deploying Messaging Solutions with Microsoft Exchange Server 2010” and I am pleased to say that I passed both of them, scoring an 812 on the 70-662 and 960 on the 70-663. I am especially pleased with the score on the PRO exam!
Overall, there’s quite a lot of overlap between the two exams, with the more heavily theory and design based PRO exam being a “high-level” of the more hands-on management and cmdlet based TS exam.</description></item><item><title>Testing access to your Exchange services with Microsoft Exchange Remote Connectivity Analyzer</title><link>https://www.definit.co.uk/2010/07/testing-access-to-your-exchange-services-with-microsoft-exchange-remote-connectivity-analyzer/</link><pubDate>Wed, 21 Jul 2010 09:27:26 +0000</pubDate><guid>https://www.definit.co.uk/2010/07/testing-access-to-your-exchange-services-with-microsoft-exchange-remote-connectivity-analyzer/</guid><description>The Microsoft Exchange Remote Connectivity Analyzer is perhaps the best tool I’ve used in a long time for troubleshooting Exchange external access – it just works! On the forums and websites I read, it doesn’t seem to get the coverage that I’d expect, so I thought I’d give it a mention.</description></item><item><title>Useful commands for troubleshooting Exchange 2010 routing with Exchange 2003/2007</title><link>https://www.definit.co.uk/2010/07/useful-commands-for-troubleshooting-exchange-2010-routing-with-exchange-20032007/</link><pubDate>Thu, 08 Jul 2010 17:05:26 +0000</pubDate><guid>https://www.definit.co.uk/2010/07/useful-commands-for-troubleshooting-exchange-2010-routing-with-exchange-20032007/</guid><description>I’ve just fixed an issue with Routing for my mixed Exchange 2003/2007/2010 environment.
The environment is a single AD domain with 4 sites, Site1, Site2, Site3 and Site4. In Site1, Site2 and Site3 there are 3 Exchange 2003 servers, one per site. In Site4 there is an Exchange 2007 SP2 server (CAS, Mailbox, HT). All the connectors required worked as expected, and inter-site routing works as expected.
I introduced into the mix a 2010 Enterprise server (CAS, Mailbox, HT) to Site1 as a prelude to a full upgrade of the site to Exchange 2010.</description></item><item><title>Exchange ActiveSync fails on iPhone after upgrade to iOS4</title><link>https://www.definit.co.uk/2010/07/exchange-activesync-fails-on-iphone-after-upgrade-to-ios4/</link><pubDate>Fri, 02 Jul 2010 15:55:36 +0000</pubDate><guid>https://www.definit.co.uk/2010/07/exchange-activesync-fails-on-iphone-after-upgrade-to-ios4/</guid><description>I’ve spent a fair bit of time today trying to sort out my iPhone sync to my Exchange Server, failing miserably. It used to work, pre-upgrade to iOS4, but for some reason fails to sync.
Symptoms were:
iPhone fails to sync, generic timeout error (or is very slow) https://www.testexchangeconnectivity.com/ successfully tests the mailbox access The server was configured as per http://support.microsoft.com/kb/817379/en-us to allow OWA/ActiveSync with SSL on OWA.
The iPhone was configured to accept the SSL certificate on the Exchange Server.</description></item><item><title>Exchange 2010 “New Local Move Request” and “New Remote Move Request” missing when you right-click a user’s MailBox</title><link>https://www.definit.co.uk/2010/06/exchange-2010-%E2%80%9Cnew-local-move-request%E2%80%9D-and-%E2%80%9Cnew-remote-move-request%E2%80%9D-missing-when-you-right-click-a-user%E2%80%99s-mailbox/</link><pubDate>Thu, 17 Jun 2010 12:14:27 +0000</pubDate><guid>https://www.definit.co.uk/2010/06/exchange-2010-%E2%80%9Cnew-local-move-request%E2%80%9D-and-%E2%80%9Cnew-remote-move-request%E2%80%9D-missing-when-you-right-click-a-user%E2%80%99s-mailbox/</guid><description>I’m currently testing an Exchange 2010 server for the organisation prior to a migration project, specifically testing moving mailboxes backwards and forwards. Something that confused me slightly for a few minutes was this: if there is an existing Move Request (pending, in progress, failed or completed) you will not see the “New Local Move Request” or “New Remote Move Request” -
Fortunately this is very simple to counter – simply clear the old “Move Request” and the options will be back in the Mailbox options:</description></item><item><title>Fixing “Outlook(R) Mobile Access is supported only on Microsoft(R) Exchange Server 2003. Currently your mailbox is stored on an older version of Exchange server.” on Outlook Mobile Access under Server 2003</title><link>https://www.definit.co.uk/2008/09/fixing-outlookr-mobile-access-is-supported-only-on-microsoftr-exchange-server-2003-currently-your-mailbox-is-stored-on-an-older-version-of-exchange-server-on-outlook-mobile-access-under-serv/</link><pubDate>Fri, 19 Sep 2008 08:32:00 +0000</pubDate><guid>https://www.definit.co.uk/2008/09/fixing-outlookr-mobile-access-is-supported-only-on-microsoftr-exchange-server-2003-currently-your-mailbox-is-stored-on-an-older-version-of-exchange-server-on-outlook-mobile-access-under-serv/</guid><description>So I was testing the configuration on my Exchange 2003 server in preparation for the roll out of some Windows Mobile devices when I recieved the following error:
Outlook(R) Mobile Access is supported only on Microsoft(R) Exchange Server 2003. Currently your mailbox is stored on an older version of Exchange server. Please contact your system administrator for additional assistance.
&amp;ldquo;That&amp;rsquo;s odd&amp;rdquo;, I thought, &amp;ldquo;I only have Exchange Server 2003 in my organisation, how can I have an older version of Exchange?</description></item><item><title>Exchange 2003 Email Size Delivery Restrictions…how confusing can it be?</title><link>https://www.definit.co.uk/2008/07/exchange-2003-email-size-delivery-restrictions-how-confusing-can-it-be/</link><pubDate>Thu, 24 Jul 2008 11:14:00 +0000</pubDate><guid>https://www.definit.co.uk/2008/07/exchange-2003-email-size-delivery-restrictions-how-confusing-can-it-be/</guid><description>I thought this would be fairly common knowledge by now, Exchange 2003 being quite mature in it&amp;rsquo;s 5th year, but it&amp;rsquo;s not something I&amp;rsquo;ve had a problem with before and therefore I&amp;rsquo;m going to write about it!
So a big email comes in; lets say it&amp;rsquo;s 8MB. Your Exchange 2003 server, set to it&amp;rsquo;s defaults for size restrictions, rejects the email. Why? Take a look at this Exchange TechNet article:</description></item><item><title>Create a 100Mb file for testing transfer speeds</title><link>https://www.definit.co.uk/2008/07/create-a-100mb-file-for-testing-transfer-speeds/</link><pubDate>Fri, 18 Jul 2008 10:58:00 +0000</pubDate><guid>https://www.definit.co.uk/2008/07/create-a-100mb-file-for-testing-transfer-speeds/</guid><description>We have a Bonded ADSL solution for our servers to provide the necessary upstream transfer speeds for the applications we host. We have bonded ADSL because our exchange still doesn&amp;rsquo;t support SDSL, and a leased line is overkill. Theoretically, we should have 28.1 Mbps download and 3.2Mbps upload - what I am actually seeing is about 1.7Mbps down and 1.9Mbps up. I have tested this on various servers, over various times and file sizes, there is no doubt that the performance is POOR.</description></item><item><title>Outlook Web Access over SSL using Forms Based Authentication AND Integrated Authentication</title><link>https://www.definit.co.uk/2008/07/outlook-web-access-over-ssl-using-forms-based-authentication-and-integrated-authentication/</link><pubDate>Wed, 16 Jul 2008 16:00:00 +0000</pubDate><guid>https://www.definit.co.uk/2008/07/outlook-web-access-over-ssl-using-forms-based-authentication-and-integrated-authentication/</guid><description>Outlook Web access is a fantastic tool for our company, providing on-the-go
access to people&amp;rsquo;s mailboxes - which is of course secured by SSL and uses Forms
Based Authentication. Internally, we have an intranet portal that allows us to
access the various systems - one of which is OWA. One of the stipulations for
this internal portal is that it is all Single Sign On using NTLM authentication
integrated authentication. This is where the problem lies because enabling OWA with Forms Based Authentication over SSL disables Integrated Authentication.</description></item><item><title>Exchange 2007 and Outlook 2007 remove categories from emails, tasks, calendar etc.</title><link>https://www.definit.co.uk/2008/05/exchange-2007-and-outlook-2007-remove-categories-from-emails-tasks-calendar-etc/</link><pubDate>Thu, 22 May 2008 11:18:00 +0000</pubDate><guid>https://www.definit.co.uk/2008/05/exchange-2007-and-outlook-2007-remove-categories-from-emails-tasks-calendar-etc/</guid><description>It seems that the nice people at Microsoft were looking out for us, lest the evil people in the world see how we categorise our email, and decided to strip away any category information from sent and received objects by default. Sure, I understand if you were categorising emails from someone as &amp;ldquo;sneaky git&amp;rdquo; or &amp;ldquo;numbnuts&amp;rdquo; then you might not be too happy about sending those out…but really it should be your choice right?</description></item><item><title>Retrieving Your Exchange Server 2003 License Key</title><link>https://www.definit.co.uk/2008/02/retrieving-your-exchange-server-2003-license-key/</link><pubDate>Thu, 21 Feb 2008 21:07:00 +0000</pubDate><guid>https://www.definit.co.uk/2008/02/retrieving-your-exchange-server-2003-license-key/</guid><description>Recently I found the need to retrieve the key from an existing Exchange Server for a reinstall - the software is legally licensed but the key was somehow lost. A trawl through my registry revealed that the key is stored in an obscure place:
HKLM\SOFTWARE\Microsoft\Microsoft Integration\{GUID}\PID3.0 This was the case on a Windows Server 2000 install with Exchange Server 2003 installed, when I get the chance I will test this on Server 2003.</description></item></channel></rss>