<!doctype html><!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]--><!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if IE 8]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class=no-js><!--<![endif]--><head><meta charset=utf-8><title>Powershell – Generate Microsoft CA signed SSL certificates with vSphere 5.1 &#183; DefinIT</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content="ca,Certificate Services,certificates,powercl,PowerCLI,PowerShell,vcenter,vsphere,"><meta property="og:title" content="Powershell – Generate Microsoft CA signed SSL certificates with vSphere 5.1  &#183; DefinIT "><meta property="og:site_name" content="DefinIT"><meta property="og:url" content="https://www.definit.co.uk/2012/11/powershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1/"><meta property="og:locale" content="en-gb"><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:article:published_time" content="2012-11-06T16:59:11Z"><meta property="og:article:modified_time" content="2012-11-06T16:59:11Z"><meta property="og:article:tag" content="ca"><meta property="og:article:tag" content="Certificate Services"><meta property="og:article:tag" content="certificates"><meta property="og:article:tag" content="powercl"><meta property="og:article:tag" content="PowerCLI"><meta property="og:article:tag" content="PowerShell"><meta property="og:article:tag" content="vcenter"><meta property="og:article:tag" content="vsphere"><meta name=twitter:card content="summary"><meta name=twitter:site content="@sammcgeown"><meta name=twitter:creator content="@sammcgeown"><meta name=twitter:title content="Powershell – Generate Microsoft CA signed SSL certificates with vSphere 5.1"><meta name=twitter:description content><meta name=twitter:url content="https://www.definit.co.uk/2012/11/powershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1/"><meta name=twitter:domain content="https://www.definit.co.uk"><link rel=canonical href=https://www.definit.co.uk/2012/11/powershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1/><link rel=apple-touch-icon-precomposed sizes=144x144 href=/touch-icon-144-precomposed.png><link rel=icon href=/images/favicon-16x16.png><meta name=generator content="Hugo 0.105.0"><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js></script>
<script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><script src=/js/clr-icons.min.js></script>
<script src=/js/custom-elements.min.js></script>
<link href=/css/clr-ui.min.css rel=stylesheet><link href=/css/clr-icons.min.css rel=stylesheet><link href=/css/definit-clarity.css rel=stylesheet><link href=/css/lightbox.min.css rel=stylesheet></head><body data-ng-app=myapp data-ng-controller=MyController data-ng-mouseleave=MouseLeave($event)><div class=main-container><header class=header-6><div class=branding><a class=navbar-brand-img href=/><img alt src=/images/logos/definit-logo.png>
<span class=title>DefinIT</span></a></div><nav class=header-nav><a class="nav-link nav-text" href=https://www.definit.co.uk/ title=Home>Home</a>
<a class="nav-link nav-text" href=https://www.definit.co.uk/about/ title=About>About</a>
<a class="nav-link nav-text" href=https://www.github.com/sammcgeown title=GitHub>GitHub</a>
<a class="nav-link nav-text" href=https://www.definit.co.uk/index.xml title=RSS>RSS</a></nav><div class=header-actions><form class=search id=search method=get action=//google.com/search><label for=search_input><input id=search_input type=text name=q placeholder="Search with Google">
<input type=hidden name=as_sitesearch value=https://www.definit.co.uk></label></form></div></header><div class=content-container><div class=content-area><h1>Powershell – Generate Microsoft CA signed SSL certificates with vSphere 5.1</h1><div class=metas><span class=clr-card-authors><div class=clr-card-authors><img src=/images/SamMcGeown2020.jpg alt class=img-author>Written by <a href=https://www.definit.co.uk/authors/sam-mcgeown/>Sam McGeown</a>
on 6/11/2012
&#183; Read in about 4 min (725 words)</div><div class=clr-card-authors>Published under <a href=/category/vmware>VMware</a></div><div class=clr-card-authors>Tags:
<a class=clr-tags href=https://www.definit.co.uk/tag/ca>#ca</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/certificate-services>#Certificate Services</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/certificates>#certificates</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/powercl>#powercl</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/powercli>#PowerCLI</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/powershell>#PowerShell</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/vcenter>#vcenter</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/vsphere>#vsphere</a></div></span></div><br clear=all><div class="alert alert-danger" role=alert><div class=alert-items><div class="alert-item static"><div class=alert-icon-wrapper><clr-icon class=alert-icon shape=warning-standard></clr-icon></div><span class=alert-text>This article is now 10 years old! It is highly likely that this information is out of date and the author will have completely forgotten about it. Please take care when following any guidance to ensure you have up-to-date recommendations.</span></div></div></div><p><img src=https://www.definit.co.uk/images/2010/11/VMware3.jpg alt>The process of requesting certificates for vSphere 5.1 is a fairly grim, manual process. It&rsquo;s repetitive and easy to make a mistake on any step of the way. Since I&rsquo;ve got to do this for quite a few VirtualCenter Servers, I thought I&rsquo;d script the certificate generation if nothing else. I am following the excellent documentation provided in <a href="http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&docType=kc&docTypeID=DT_KB_1_1&externalId=2034833" target=_blank>Implementing CA signed SSL certificates with vSphere 5.1</a> and more specifically in <a href="http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&docType=kc&docTypeID=DT_KB_1_1&externalId=2037432" target=_blank>Creating certificate requests and certificates for vCenter Server 5.1 components</a>.</p><p>The script assumes that:</p><ol><li>You have a working Certificate Authority</li><li>You are in an Active Directory domain environment</li><li>You have the relevant permissions to modify Certificate Templates, Request and Issue certificates.</li><li>You have installed OpenSSL v1.0.1c or later.</li></ol><p>You will need to modify the configuration section to suit your environment and the $WorkingDir folder should exist before you run the script.</p><h2 id=creating-the-certificate-template>Creating the Certificate Template <a class=anchor href=#creating-the-certificate-template><i class="fas fa-hashtag"></i></a></h2><p>You need to modify the standard Microsoft Web Server template to allow the encryption of user data. Since you can&rsquo;t edit these templates, you have to duplicate the  template and modify the settings.</p><div id=gallery-2 class='gallery galleryid-1401 gallery-columns-4 gallery-size-thumbnail'><dl class=gallery-item><dt class='gallery-icon portrait'><a href=/images/2012/11/2012-11-06-001.png><img width=98 height=150 src=/images/2012/11/2012-11-06-001.png class="attachment-thumbnail size-thumbnail" alt="01 - Manage Certificate Templates" aria-describedby=gallery-2-1403></a></dt><pre><code>&lt;dd class='wp-caption-text gallery-caption' id='gallery-2-1403'&gt;
  Log on to the Certificate Authority and Open the Certification Authority console. Right click on the Certificate Templates folder and select Manage.
&lt;/dd&gt;
</code></pre></dl><dl class=gallery-item><dt class='gallery-icon portrait'><a href=/images/2012/11/2012-11-06-002.png><img width=130 height=150 src=/images/2012/11/2012-11-06-002.png class="attachment-thumbnail size-thumbnail" alt="03 - Modify Certificate Template" aria-describedby=gallery-2-1404></a></dt><pre><code>&lt;dd class='wp-caption-text gallery-caption' id='gallery-2-1404'&gt;
  Name the certificate meanfully - I used &quot;Virtual Center Web Server&quot; and note the shortened template name, in this case &quot;VirtualCenterWebServer&quot;.
&lt;/dd&gt;
</code></pre></dl><dl class=gallery-item><dt class='gallery-icon portrait'><a href=/images/2012/11/2012-11-06-003.png><img width=139 height=150 src=/images/2012/11/2012-11-06-003.png class="attachment-thumbnail size-thumbnail" alt="04 - Enable Signing of User Data" aria-describedby=gallery-2-1405></a></dt><pre><code>&lt;dd class='wp-caption-text gallery-caption' id='gallery-2-1405'&gt;
  Select the &quot;Extensions&quot; tab, select &quot;Key Usage&quot; and click the &quot;Edit&amp;#8230;&quot; button. Tick the &quot;Allow encryption of user data&quot; and click OK, and OK again to save the new template.
&lt;/dd&gt;
</code></pre></dl><dl class=gallery-item><dt class='gallery-icon landscape'><a href=/images/2012/11/2012-11-06-005.png><img width=150 height=49 src=/images/2012/11/2012-11-06-005.png class="attachment-thumbnail size-thumbnail" alt></a></dt></dl><br style=clear:both><dl class=gallery-item><dt class='gallery-icon landscape'><a href=/images/2012/11/2012-11-06-004.png><img width=150 height=140 src=/images/2012/11/2012-11-06-004.png class="attachment-thumbnail size-thumbnail" alt></a></dt></dl><br style=clear:both></div><p>Download the CA&rsquo;s certificate as per the instructions in the linked KB above:</p><blockquote><ul><li><p>Navigate back to the home page of the certificate server and click on <strong>Download a CA certificate, certificate chain or CRL</strong>.</p></li><li><div>Click the <strong>Base 64</strong> option.</div></li><li><div>Click the <strong>Download CA Certificate chain</strong> link.</div></li><li><div>Save the certificate chain as cachain.p7b. in the c:\certs folder.</div></li><li><div>Double-click on the cachain.p7b file and navigate to <strong>C:\certs\cachain.p7b > Certificates</strong>.</div></li><li><div>Right-click on the certificate listed and select <strong>All Actions > Export</strong>.</div></li><li><div>Click <strong>Next</strong>.</div></li><li><div>Select <strong>Base-64 encoded X.509 (.CER)</strong>, and then click <strong>Next</strong>.</div></li><li><div>Save the export at C:\[Your $WorkingDir]\Root64.cer and click <strong>Next</strong>.</div></li></ul></blockquote><h2 id=running-the-script>Running the script <a class=anchor href=#running-the-script><i class="fas fa-hashtag"></i></a></h2><p>The script itself is fairly simple, creating a folder structure for the individual certificates, wrestling with OpenSSL and handling the requests to the CA using CertReq. You can view the debug output by setting the $DebugPreference to &lsquo;Continue&rsquo;</p><p> </p><pre class="brush: powershell; gutter: true"># The "short" name of the Virtual Center Server
$vC_NETBIOS = "DefinIT-VC01"
# The DNS name of the Virtual Center Server
$vC_FQDN = "DefinIT-VC01.definit.co.uk"
# The IP address of the Virtual Center Server
$vC_IP = "192.168.1.10"
# The Certificate Authority Name
$CA_Name = "DefinIT-CA01\DefinIT-CA"
# The name of the template you defined earlier
$CA_Template = "CertificateTemplate:VirtualCenterWebServer"
# The CA certificate you exported earlier
$CA_Certificate = "Root64.cer"
# Administrative email to use in the certificate
$AdminEmail = "admin@definit.co.uk"
# A working directory under which the certificates and folders will be created
$WorkingDir = "c:\Certificates\VMCertificates"
# An array of the services we will generate the certificates for
$Services = @("vCenterServer","vCenterInventoryService","vCenterSSO","VMwareUpdateManager","vCenterWebClient","vCenterLogBrowser","VMwareOrchestrator")# The path to the openssl executable
$OpenSSLExe =  "c:\OpenSSL-Win32\bin\openssl.exe"

if (!(Test-Path $OpenSSLExe)) {throw "$OpenSSLExe required"}
New-Alias -Name OpenSSL $OpenSSLExe

$RequestTemplate = "[ req ]
default_bits = 2048
default_keyfile = rui.key
distinguished_name = req_distinguished_name
encrypt_key = no
prompt = no
string_mask = nombstr
req_extensions = v3_req

[ v3_req ]
basicConstraints = CA:FALSE
keyUsage = digitalSignature, keyEncipherment, dataEncipherment
extendedKeyUsage = serverAuth
subjectAltName = DNS:ShortName,DNS:FQDN, DNS:IPADDRESS

[ req_distinguished_name ]
countryName = UK
stateOrProvinceName = West Sussex
localityName = Horsham
0.organizationName = DefinIT
organizationalUnitName = ORGREPLACE
commonName = FQDN
emailAddress = ADMINEMAIL

[ v3_ca ]
subjectKeyIdentifier=hash
authorityKeyIdentifier=keyid:always,issuer
basicConstraints = CA:true

[ req_attributes ]"

if(!(Test-Path $WorkingDir)) {
	New-Item $WorkingDir -Type Directory
}
Set-Location $WorkingDir
ForEach ($Service in $Services) {
	if(!(Test-Path $Service)) {
		New-Item $Service -Type Directory
	}
	Set-Location $Service
	write-debug "$Service: Writing Template"
	$Out = ((((($RequestTemplate -replace "FQDN", $vC_FQDN) -replace "ShortName", $vC_NETBIOS) -replace "ORGREPLACE", $Service) -replace "ADMINEMAIL", $AdminEmail) -replace "IPADDRESS", $vC_IP) | Out-File "$WorkingDir\$Service\$Service.cfg" -Encoding Default -Force
	write-debug "$Service: Generating CSR"
	OpenSSL req -new -nodes -out "$WorkingDir\$Service\$Service.csr" -keyout "$WorkingDir\$Service\rui-orig.key" -config "$WorkingDir\$Service\$Service.cfg"
	write-debug "$Service: Converting Private Key"
	OpenSSL rsa -in "$WorkingDir\$Service\rui-orig.key" -out "$WorkingDir\$Service\rui.key"
	write-debug "$Service: Submitting to $CA_Name"
	certreq -submit -attrib $CA_Template -config "$CA_Name" "$Service.csr" "$WorkingDir\$Service\rui.crt"
	write-debug "$Service: Generating PFX"
	OpenSSL pkcs12 -export -in "$WorkingDir\$Service\rui.crt" -inkey "$WorkingDir\$Service\rui.key" -certfile "$WorkingDir\$CA_Certificate" -name "rui" -passout pass:testpassword -out "$WorkingDir\$Service\rui.pfx"
	Set-Location $WorkingDir
}</pre><p> </p><p><img src=https://www.definit.co.uk/images/2012/11/2012-11-06-004.png alt></p><p><img src=https://www.definit.co.uk/images/2012/11/2012-11-06-005.png alt></p><p> </p><p> </p><p> </p><h6>Share this post</h6><span class=share-box><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f" onclick='return window.open(this.href,"mywin","left=20,top=20,width=500,height=500,toolbar=1,resizable=0"),!1'><i class="fa fa-facebook-official"></i></a>
<a href="https://twitter.com/intent/tweet?text=Powershell%20%e2%80%93%20Generate%20Microsoft%20CA%20signed%20SSL%20certificates%20with%20vSphere%205.1&url=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f" onclick='return window.open(this.href,"mywin","left=20,top=20,width=500,height=500,toolbar=1,resizable=0"),!1'><i class="fa fa-twitter"></i></a>
<a href="https://plus.google.com/share?url=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f" onclick='return window.open(this.href,"mywin","left=20,top=20,width=500,height=500,toolbar=1,resizable=0"),!1'><i class="fa fa-google-plus"></i></a>
<a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f" onclick='return window.open(this.href,"mywin","left=20,top=20,width=900,height=500,toolbar=1,resizable=0"),!1'><i class="fa fa-reddit"></i></a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f&title=Powershell%20%e2%80%93%20Generate%20Microsoft%20CA%20signed%20SSL%20certificates%20with%20vSphere%205.1" onclick='return window.open(this.href,"mywin","left=20,top=20,width=500,height=500,toolbar=1,resizable=0"),!1'><i class="fa fa-linkedin"></i></a>
<a href="mailto:?subject=Powershell%20%e2%80%93%20Generate%20Microsoft%20CA%20signed%20SSL%20certificates%20with%20vSphere%205.1&body=Check out this site https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f" data-proofer-ignore><i class="fa fa-envelope"></i></a></span>
<a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=Powershell%20%e2%80%93%20Generate%20Microsoft%20CA%20signed%20SSL%20certificates%20with%20vSphere%205.1&url=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5.0-4.55 2.04-4.55 4.54.0.36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3.0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35.0 12.92-6.92 12.92-12.93.0-.2.0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&title=Powershell%20%e2%80%93%20Generate%20Microsoft%20CA%20signed%20SSL%20certificates%20with%20vSphere%205.1&caption=Powershell%20%e2%80%93%20Generate%20Microsoft%20CA%20signed%20SSL%20certificates%20with%20vSphere%205.1&content=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f&canonicalUrl=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f&shareSource=tumblr_share_button" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.5.5v5h5v4h-5V15c0 5 3.5 4.4 6 2.8v4.4c-6.7 3.2-12 0-12-4.2V9.5h-3V6.7c1-.3 2.2-.7 3-1.3.5-.5 1-1.2 1.4-2 .3-.7.6-1.7.7-3h3.8z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f&title=Powershell%20%e2%80%93%20Generate%20Microsoft%20CA%20signed%20SSL%20certificates%20with%20vSphere%205.1&summary=Powershell%20%e2%80%93%20Generate%20Microsoft%20CA%20signed%20SSL%20certificates%20with%20vSphere%205.1&source=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6.0 2.5 1 2.6 2.5.0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f&resubmit=true&title=Powershell%20%e2%80%93%20Generate%20Microsoft%20CA%20signed%20SSL%20certificates%20with%20vSphere%205.1" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96.0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65.0 3-1.35 3-3s-1.35-3-3-3c-1.38.0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65.0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66.0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64.0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4.0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6.0.23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1.0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1.0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=Powershell%20%e2%80%93%20Generate%20Microsoft%20CA%20signed%20SSL%20certificates%20with%20vSphere%205.1&body=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f" target=_self rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9.0 6v12c0 1.1.9 2 2 2h20c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17.0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1.0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08.0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></div></div></a><a class=resp-sharing-button__link href="whatsapp://send?text=Powershell%20%e2%80%93%20Generate%20Microsoft%20CA%20signed%20SSL%20certificates%20with%20vSphere%205.1%20https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3.0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7.0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1.0-5.2 4.2-9.4 9.4-9.4 2.5.0 4.9 1 6.7 2.8s2.8 4.2 2.8 6.7c-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2s0-.5.1-.6.3-.3.4-.5c.2-.1.3-.3.4-.5s0-.4.0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://telegram.me/share/url?text=Powershell%20%e2%80%93%20Generate%20Microsoft%20CA%20signed%20SSL%20certificates%20with%20vSphere%205.1&url=https%3a%2f%2fwww.definit.co.uk%2f2012%2f11%2fpowershell-generate-microsoft-ca-signed-ssl-certificates-with-vsphere-5-1%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.707 8.475C.275 8.64.0 9.508.0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102.0 001.75.527l2.96-2.41a.405.405.0 01.494-.013l5.34 3.87a1.1 1.1.0 001.046.135 1.1 1.1.0 00.682-.803l3.91-18.795A1.102 1.102.0 0022.5.075L.706 8.475z"/></svg></div></div></a><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var e=document.createElement("script");e.async=!0,e.type="text/javascript",e.src="//definit.disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><div class="clarity-prev-next col-xs-12 col-sm-12 col-md-12 col-lg-12"><nav class=clarity-page-prev-next><div class=clr-nav-previous><a href=https://www.definit.co.uk/2012/10/installing-vmware-vsphere-single-sign-on-sso-in-multi-site-mode/ title="Installing VMware vSphere Single Sign On (SSO) in Multi-site Mode" class="btn btn-sm btn-outline">Previous</a></div><div class=clr-nav-next><a href=https://www.definit.co.uk/2012/11/vcp5-vsphere-5-configuration-maximums-quiz-in-powershell/ title="VCP5 – vSphere 5 Configuration Maximums Quiz in PowerShell" class="btn btn-sm btn-outline">Next</a></div></nav></div></div><nav class="sidenav clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><section class=sidenav-content><section class="nav-group collapsible"><input id=Categories type=checkbox>
<label for=Categories>Categories</label><ul class=nav-list><li><a href=/category/career class=nav-link>CAREER <span class="badge badge-1">25</span></a></li><li><a href=/category/cloud-native class=nav-link>CLOUD-NATIVE <span class="badge badge-1">16</span></a></li><li><a href=/category/community class=nav-link>COMMUNITY <span class="badge badge-1">44</span></a></li><li><a href=/category/microsoft class=nav-link>MICROSOFT <span class="badge badge-1">60</span></a></li><li><a href=/category/networking class=nav-link>NETWORKING <span class="badge badge-1">29</span></a></li><li><a href=/category/nsx class=nav-link>NSX <span class="badge badge-1">16</span></a></li><li><a href=/category/vcf class=nav-link>VCF <span class="badge badge-1">2</span></a></li><li><a href=/category/vmware class=nav-link>VMWARE <span class="badge badge-1">206</span></a></li><li><a href=/category/vmware-aria class=nav-link>VMWARE-ARIA <span class="badge badge-1">1</span></a></li><li><a href=/category/vrealize-automation class=nav-link>VREALIZE-AUTOMATION <span class="badge badge-1">40</span></a></li><li><a href=/category/vrealize-operations class=nav-link>VREALIZE-OPERATIONS <span class="badge badge-1">71</span></a></li><li><a href=/category/vrealize-orchestrator class=nav-link>VREALIZE-ORCHESTRATOR <span class="badge badge-1">23</span></a></li><li><a href=/category/vsphere class=nav-link>VSPHERE <span class="badge badge-1">56</span></a></li></ul></section><section class="nav-group collapsible"><input id=Tags type=checkbox>
<label for=Tags>Tags (Top 10)</label><ul class=nav-list><li><a href=/tag/vrops class=nav-link>VROPS <span class="badge badge-1">68</span></a></li><li><a href=/tag/vmware class=nav-link>VMWARE <span class="badge badge-1">56</span></a></li><li><a href=/tag/automation class=nav-link>AUTOMATION <span class="badge badge-1">40</span></a></li><li><a href=/tag/windows class=nav-link>WINDOWS <span class="badge badge-1">38</span></a></li><li><a href=/tag/vmworld class=nav-link>VMWORLD <span class="badge badge-1">34</span></a></li><li><a href=/tag/esx-and-esxi class=nav-link>ESX-AND-ESXI <span class="badge badge-1">33</span></a></li><li><a href=/tag/vcenter-server class=nav-link>VCENTER-SERVER <span class="badge badge-1">33</span></a></li><li><a href=/tag/nsx class=nav-link>NSX <span class="badge badge-1">32</span></a></li><li><a href=/tag/vra class=nav-link>VRA <span class="badge badge-1">30</span></a></li><li><a href=/tag/webinar class=nav-link>WEBINAR <span class="badge badge-1">29</span></a></li></section></section></nav></div><script async src="https://www.googletagmanager.com/gtag/js?id=UA-4368767-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-4368767-1")</script><script src=/js/lightbox-plus-jquery.min.js></script></div></body></html>