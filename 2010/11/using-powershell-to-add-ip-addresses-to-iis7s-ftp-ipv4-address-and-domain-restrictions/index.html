<!doctype html><!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]--><!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if IE 8]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class=no-js><!--<![endif]--><head><meta charset=utf-8><title>Using PowerShell to add IP addresses to IIS7&amp;rsquo;s FTP IPv4 Address and Domain Restrictions &#183; DefinIT</title><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content="ftp,IIS,iis7,IP address,PowerShell,PowerShell,Security,"><meta property="og:title" content="Using PowerShell to add IP addresses to IIS7&amp;rsquo;s FTP IPv4 Address and Domain Restrictions  &#183; DefinIT "><meta property="og:site_name" content="DefinIT"><meta property="og:url" content="https://www.definit.co.uk/2010/11/using-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions/"><meta property="og:locale" content="en-gb"><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:article:published_time" content="2010-11-24T10:55:04Z"><meta property="og:article:modified_time" content="2010-11-24T10:55:04Z"><meta property="og:article:tag" content="ftp"><meta property="og:article:tag" content="IIS"><meta property="og:article:tag" content="iis7"><meta property="og:article:tag" content="IP address"><meta property="og:article:tag" content="PowerShell"><meta property="og:article:tag" content="PowerShell"><meta property="og:article:tag" content="Security"><meta name=twitter:card content="summary"><meta name=twitter:site content="@sammcgeown"><meta name=twitter:creator content="@sammcgeown"><meta name=twitter:title content="Using PowerShell to add IP addresses to IIS7&amp;rsquo;s FTP IPv4 Address and Domain Restrictions"><meta name=twitter:description content><meta name=twitter:url content="https://www.definit.co.uk/2010/11/using-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions/"><meta name=twitter:domain content="https://www.definit.co.uk/"><link rel=canonical href=https://www.definit.co.uk/2010/11/using-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config content="/browserconfig.xml"><meta name=theme-color content="#ffffff"><meta name=generator content="Hugo 0.152.2"><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js></script><script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><script src=/js/clr-icons.min.js></script><script src=/js/custom-elements.min.js></script><script src=/js/clr-toggle-darkmode.js></script><link id=dark-mode-css disabled href=/css/clr-ui-dark.min.css rel=stylesheet type=text/css as=style><link id=light-mode-css href=/css/clr-ui.min.css rel=stylesheet type=text/css as=style><link href=/css/clr-icons.min.css rel=stylesheet><link href=/css/definit-clarity.css rel=stylesheet><link href=/css/syntax-highlighting.css rel=stylesheet><link href=/css/lightbox.min.css rel=stylesheet></head><body id=body onload='setCurrentTheme("dark")'><clr-main-container class=main-container><header class=header-6><div class=branding><a class=logo-and-title href=/><img class=clr-header-logo alt src=/images/logos/definit-logo.png>
<span class=title>&nbsp;DefinIT</span></a></div><nav class=header-nav><a class="nav-link nav-text" href=https://www.definit.co.uk/ title=Home>Home
</a><a class="nav-link nav-text" href=https://www.definit.co.uk/about/ title=About>About
</a><a class="nav-link nav-text" href=https://www.github.com/sammcgeown title=GitHub>GitHub
</a><a class="nav-link nav-text" href=https://www.definit.co.uk/index.xml title=RSS>RSS</a></nav><div class=header-actions><form class=search id=search method=get action=//google.com/search><label for=search_input><input id=search_input type=text name=q placeholder="Search with Google">
<input type=hidden name=as_sitesearch value=https://www.definit.co.uk/></label></form><a class="nav-link nav-icon" aria-label=theme onclick=toggleThemeMode()><clr-icon shape=moon id=icon-theme-mode title="Toggle theme mode"></clr-icon></a></div></header><div class=content-container><div class=content-area><h1>Using PowerShell to add IP addresses to IIS7&amp;rsquo;s FTP IPv4 Address and Domain Restrictions</h1><div class=metas><span class=clr-card-authors><div class=clr-card-authors>Written by
<img src=/images/SamMcGeown2020.jpg alt class=img-author>
&lt;a class="" href="/category/sam-mcgeown">Sam McGeown&lt;/a></div><div class=clr-card-authors>Published on 24/11/2010 -
Read in about 3 min (497 words)</div><div class=clr-card-authors>Published under
&lt;a class="" href="/category/microsoft">Microsoft&lt;/a>
<a class=clr-tags href=https://www.definit.co.uk/tag/ftp>#ftp</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/iis>#IIS</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/iis7>#iis7</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/ip-address>#IP address</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/powershell>#PowerShell</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/powershell>#PowerShell</a>
<a class=clr-tags href=https://www.definit.co.uk/tag/security>#Security</a></div></span></div><br clear=all><div class="alert alert-danger" role=alert><div class=alert-items><div class="alert-item static"><div class=alert-icon-wrapper><clr-icon class=alert-icon shape=warning-standard></clr-icon></div><span class=alert-text>This article is now 15 years old! It is highly likely that this information is out of date and the author will have completely forgotten about it. Please take care when following any guidance to ensure you have up-to-date recommendations.</span></div></div></div><p>Today I was configuring a new FTP server based on IIS7 (well, 7.5 technically as it’s a Server 2008 R2 host), and I wanted an easy way to add and remove allowed IP addresses based on either an XML config file or a CSV import. Customers’ IP addresses are added or removed regularly, but I didn’t want to have to update their details twice, once on the server and once in the documents.</p><p>I figured that the PowerShell extensions for managing IIS would do nicely – they are great for managing IIS sites after all and the idea with FTP in IIS7 is that it doesn’t care which protocol you are using, HTTP, HTTPS, FTP or FTP over SSL – all should be configured the same way.</p><p>The security setup had to follow the policy that all IP addresses are denied unless explicitly allowed.</p><p>I imported the module and listed the cmdlets:</p><blockquote><p>Import-Module –Name WebAdministration</p><p>Get-Command –PSSnapin WebAdministration</p></blockquote><h3 id=creating-a-new-ftp-site>Creating a new FTP site <a class=anchor href=#creating-a-new-ftp-site><i class="fas fa-hashtag"></i></a></h3><p>This is very, very simple with PowerShell</p><blockquote><p>New-WebFtpSite -Name &lsquo;FTP Site&rsquo; -IPAddress &lsquo;192.168.10.22&rsquo; -HostHeader &lsquo;ftp.mcgeown.co.uk&rsquo; -PhysicalPath &rsquo;d:\FTP\</p></blockquote><p><img src=https://www.definit.co.uk/images/2010/11/image_thumb26.png alt></p><p>A good start then!</p><p>By default, the site will allow any IP address to access the server – it’s time to start locking it down.</p><h3 id=allow-authorised-users>Allow Authorised Users <a class=anchor href=#allow-authorised-users><i class="fas fa-hashtag"></i></a></h3><blockquote><ol><li>Add-WebConfiguration -Filter /system.ftpserver/security/authorization -PSPath &lsquo;IIS:' -Value @{accessType=&lsquo;Allow&rsquo;;users=&rsquo;*&rsquo;;permissions=3} -Location &lsquo;FTP Site&rsquo;</li></ol></blockquote><h3 id=restricting-ip-access>Restricting IP Access <a class=anchor href=#restricting-ip-access><i class="fas fa-hashtag"></i></a></h3><p>Unfortunately the IP Address Restrictions part of the configuration isn’t exposed directly by a cmdlet so I thought I’d use one or two of the lower level IIS configuration cmdlets – Add-WebConfiguration, and Set-WebConfigurationProperty. And after a lot of fiddling and a lot of help by a colleague, I stumbled upon the correct syntax:</p><blockquote><ol start=2><li><p>Set-WebConfigurationProperty -Filter /system.ftpserver/security/ipsecurity -Name allowUnlisted -Value $false -Location &lsquo;FTP Site&rsquo; -PSPath &lsquo;IIS:'</p></li><li><p>Add-WebConfiguration -Filter /system.ftpserver/security/ipsecurity -PSPath &lsquo;IIS:' -Value @{ipAddress=’192.168.1.1’;subnetMask=’255.255.255.255’;allowed=$true} –Location ‘FTP Site’</p></li></ol></blockquote><p>The following code is appended to the end of the applicationHost.config file – now hopefully you can see that the crazy colours relate to the section in the same colour on below:</p><blockquote><p>&#171;span style=&ldquo;color: #ff00ff&rdquo;>location path=&ldquo;FTP Site&rdquo; ><br>&#171;span style=&ldquo;color: #004000&rdquo;>system.ftpServer><br>&#171;span style=&ldquo;color: #008000&rdquo;>security><br>&#171;span style=&ldquo;color: #00ff00&rdquo;>ipSecurity allowUnlisted=&ldquo;false&rdquo;><br>&#171;span style=&ldquo;color: #ff8000&rdquo;>add ipAddress=&ldquo;192.168.1.1&rdquo; allowed=&ldquo;true&rdquo; /><br>&lt;/ipSecurity><br>&#171;span style=&ldquo;color: #80ff00&rdquo;>authorization><br>&#171;span style=&ldquo;color: #8000ff&rdquo;>add accessType=&ldquo;Allow&rdquo; users="*" permissions=&ldquo;Read, Write&rdquo; /><br>&lt;/authorization><br>&lt;/security><br>&lt;/system.ftpServer><br>&lt;/location></p></blockquote><h3 id=scripting-the-whole-thing>Scripting the whole thing <a class=anchor href=#scripting-the-whole-thing><i class="fas fa-hashtag"></i></a></h3><p>I’ve created two files, Add-AllowedIPs.ps1 and AllowedIPs.config. The config file is just an XML structure with the allowed IPs and Site name:</p><blockquote></blockquote><p>The ps1 file is a simple script to read the configuration and apply the settings:</p><blockquote><p>$ConfigFile= &ldquo;AllowedIPs.config&rdquo;<br>if(Test-Path $ConfigFile){[xml]$Config = Get-Content $ConfigFile}else{throw (&ldquo;Unable to find configuration file: " + $ConfigFile)}</p><p>$Site = $Config.Configuration.Site.Name<br>Write-Host &ldquo;Clearing $Site IP Security Lists&rdquo; -BackgroundColor Yellow -ForegroundColor DarkBlue<br>Clear-WebConfiguration -Filter /system.ftpserver/security/ipsecurity -PSPath &lsquo;IIS:' -Location &ldquo;$Site&rdquo;<br>Write-Host &ldquo;Adding Allowed IPs to $Site&rdquo; -BackgroundColor Yellow -ForegroundColor DarkBlue<br>$Config.Configuration.Site.Address | foreach {<br>$IP = $<em>.IP.Trim()<br>$SubnetMask = $</em>.SubnetMask.Trim()<br>Add-WebConfiguration -Filter /system.ftpserver/security/ipsecurity -PSPath &lsquo;IIS:' -Location &ldquo;$Site&rdquo; -Value @{ipAddress="$IP&rdquo;;subnetMask="$SubnetMask";allowed=$true}<br>}</p></blockquote><p>Not quite sure why doing something so simple should have occupied so much of my time, but I hope it saves you some!</p><p>Sam</p><h6>Share this post</h6><span class=share-box><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f" onclick='return window.open(this.href,"mywin","left=20,top=20,width=500,height=500,toolbar=1,resizable=0"),!1'><i class="fa fa-facebook-official"></i></a>
<a href="https://twitter.com/intent/tweet?text=Using%20PowerShell%20to%20add%20IP%20addresses%20to%20IIS7%26rsquo%3bs%20FTP%20IPv4%20Address%20and%20Domain%20Restrictions&amp;url=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f" onclick='return window.open(this.href,"mywin","left=20,top=20,width=500,height=500,toolbar=1,resizable=0"),!1'><i class="fa fa-twitter"></i></a>
<a href="https://plus.google.com/share?url=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f" onclick='return window.open(this.href,"mywin","left=20,top=20,width=500,height=500,toolbar=1,resizable=0"),!1'><i class="fa fa-google-plus"></i></a>
<a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f" onclick='return window.open(this.href,"mywin","left=20,top=20,width=900,height=500,toolbar=1,resizable=0"),!1'><i class="fa fa-reddit"></i></a>
<a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f&amp;title=Using%20PowerShell%20to%20add%20IP%20addresses%20to%20IIS7%26rsquo%3bs%20FTP%20IPv4%20Address%20and%20Domain%20Restrictions" onclick='return window.open(this.href,"mywin","left=20,top=20,width=500,height=500,toolbar=1,resizable=0"),!1'><i class="fa fa-linkedin"></i></a>
<a href="mailto:?subject=Using%20PowerShell%20to%20add%20IP%20addresses%20to%20IIS7%26rsquo%3bs%20FTP%20IPv4%20Address%20and%20Domain%20Restrictions&amp;body=Check out this site https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f" data-proofer-ignore><i class="fa fa-envelope"></i></a>
</span><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=Using%20PowerShell%20to%20add%20IP%20addresses%20to%20IIS7%26rsquo%3bs%20FTP%20IPv4%20Address%20and%20Domain%20Restrictions&amp;url=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5.0-4.55 2.04-4.55 4.54.0.36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3.0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35.0 12.92-6.92 12.92-12.93.0-.2.0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=Using%20PowerShell%20to%20add%20IP%20addresses%20to%20IIS7%26rsquo%3bs%20FTP%20IPv4%20Address%20and%20Domain%20Restrictions&amp;caption=Using%20PowerShell%20to%20add%20IP%20addresses%20to%20IIS7%26rsquo%3bs%20FTP%20IPv4%20Address%20and%20Domain%20Restrictions&amp;content=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f&amp;canonicalUrl=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f&amp;shareSource=tumblr_share_button" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24"><path d="M13.5.5v5h5v4h-5V15c0 5 3.5 4.4 6 2.8v4.4c-6.7 3.2-12 0-12-4.2V9.5h-3V6.7c1-.3 2.2-.7 3-1.3.5-.5 1-1.2 1.4-2 .3-.7.6-1.7.7-3h3.8z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f&amp;title=Using%20PowerShell%20to%20add%20IP%20addresses%20to%20IIS7%26rsquo%3bs%20FTP%20IPv4%20Address%20and%20Domain%20Restrictions&amp;summary=Using%20PowerShell%20to%20add%20IP%20addresses%20to%20IIS7%26rsquo%3bs%20FTP%20IPv4%20Address%20and%20Domain%20Restrictions&amp;source=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6.0 2.5 1 2.6 2.5.0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f&amp;resubmit=true&amp;title=Using%20PowerShell%20to%20add%20IP%20addresses%20to%20IIS7%26rsquo%3bs%20FTP%20IPv4%20Address%20and%20Domain%20Restrictions" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96.0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65.0 3-1.35 3-3s-1.35-3-3-3c-1.38.0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65.0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66.0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64.0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4.0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6.0.23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1.0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1.0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=Using%20PowerShell%20to%20add%20IP%20addresses%20to%20IIS7%26rsquo%3bs%20FTP%20IPv4%20Address%20and%20Domain%20Restrictions&amp;body=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f" target=_self rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9.0 6v12c0 1.1.9 2 2 2h20c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17.0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1.0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08.0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></div></div></a><a class=resp-sharing-button__link href="whatsapp://send?text=Using%20PowerShell%20to%20add%20IP%20addresses%20to%20IIS7%26rsquo%3bs%20FTP%20IPv4%20Address%20and%20Domain%20Restrictions%20https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3.0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7.0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1.0-5.2 4.2-9.4 9.4-9.4 2.5.0 4.9 1 6.7 2.8s2.8 4.2 2.8 6.7c-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2s0-.5.1-.6.3-.3.4-.5c.2-.1.3-.3.4-.5s0-.4.0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://telegram.me/share/url?text=Using%20PowerShell%20to%20add%20IP%20addresses%20to%20IIS7%26rsquo%3bs%20FTP%20IPv4%20Address%20and%20Domain%20Restrictions&amp;url=https%3a%2f%2fwww.definit.co.uk%2f2010%2f11%2fusing-powershell-to-add-ip-addresses-to-iis7s-ftp-ipv4-address-and-domain-restrictions%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24"><path d="M.707 8.475C.275 8.64.0 9.508.0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102.0 001.75.527l2.96-2.41a.405.405.0 01.494-.013l5.34 3.87a1.1 1.1.0 001.046.135 1.1 1.1.0 00.682-.803l3.91-18.795A1.102 1.102.0 0022.5.075L.706 8.475z"/></svg></div></div></a><div class="clarity-prev-next col-xs-12 col-sm-12 col-md-12 col-lg-12"><nav class=clarity-page-prev-next><div class=clr-nav-previous><a href=https://www.definit.co.uk/2010/11/configuring-software-iscsi-multipathing-on-esxi-4-1/ title="Configuring Software iSCSI multipathing on ESXi 4.1" class="btn btn-sm btn-outline">Previous</a></div><div class=clr-nav-next><a href=https://www.definit.co.uk/2010/12/using-system-centre-operations-manager-2007-r2-audit-collection-service-for-remote-dmz-or-workgroup-servers/ title="Using System Center Operations Manager 2007 R2 Audit Collection Services for remote, DMZ or workgroup servers" class="btn btn-sm btn-outline">Next</a></div></nav></div></div><clr-vertical-nav class="clr-vertical-nav has-nav-groups"><div class=nav-content><section class=sidenav-content><clr-vertical-nav-group class=nav-group><div class=nav-group-content><button type=button class=nav-group-trigger aria-expanded=false aria-label="Toggle vertical navigation group" onclick='toggleNavigation("categories")'><div class=nav-group-text>Categories</div><clr-icon shape=angle class=nav-group-trigger-icon id=icon-categories dir=down title=Collapse></clr-icon></button></div><div id=section-categories class=nav-group-children><clr-vertical-nav-group-children><a class=nav-link href=https://www.definit.co.uk/category/career/><span class=nav-text>career <span class="badge badge-1">28</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/cloud-native/><span class=nav-text>cloud-native <span class="badge badge-1">17</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/community/><span class=nav-text>community <span class="badge badge-1">46</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/microsoft/><span class=nav-text>microsoft <span class="badge badge-1">60</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/networking/><span class=nav-text>networking <span class="badge badge-1">29</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/nsx/><span class=nav-text>nsx <span class="badge badge-1">16</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/vcf/><span class=nav-text>vcf <span class="badge badge-1">2</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/vmware/><span class=nav-text>vmware <span class="badge badge-1">206</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/vmware-aria/><span class=nav-text>vmware aria <span class="badge badge-1">1</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/vmware-multi-cloud/><span class=nav-text>vmware multi-cloud <span class="badge badge-1">1</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/vrealize-automation/><span class=nav-text>vrealize automation <span class="badge badge-1">40</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/vrealize-operations/><span class=nav-text>vrealize operations <span class="badge badge-1">71</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/vrealize-orchestrator/><span class=nav-text>vrealize orchestrator <span class="badge badge-1">23</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/category/vsphere/><span class=nav-text>vsphere <span class="badge badge-1">56</span></span></a></clr-vertical-nav-group-children></div></clr-vertical-nav-group><div class=nav-divider></div><clr-vertical-nav-group class=nav-group><div class=nav-group-content><button type=button class=nav-group-trigger aria-expanded=false aria-label="Toggle vertical navigation group" onclick='toggleNavigation("tags")'><div class=nav-group-text>Tags (Top 10)</div><clr-icon shape=angle class=nav-group-trigger-icon id=icon-tags dir=down title=Collapse></clr-icon></button></div><div id=section-tags class=nav-group-children><clr-vertical-nav-group-children><a class=nav-link href=https://www.definit.co.uk/tag/vrops/><span class=nav-text>vrops <span class="badge badge-1">68</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/tag/vmware/><span class=nav-text>vmware <span class="badge badge-1">57</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/tag/nsx/><span class=nav-text>nsx <span class="badge badge-1">41</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/tag/automation/><span class=nav-text>automation <span class="badge badge-1">40</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/tag/windows/><span class=nav-text>windows <span class="badge badge-1">38</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/tag/vmworld/><span class=nav-text>vmworld <span class="badge badge-1">34</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/tag/esx-and-esxi/><span class=nav-text>esx and esxi <span class="badge badge-1">33</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/tag/vcenter-server/><span class=nav-text>vcenter server <span class="badge badge-1">33</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/tag/vra/><span class=nav-text>vra <span class="badge badge-1">30</span></span>
</a><a class=nav-link href=https://www.definit.co.uk/tag/webinar/><span class=nav-text>webinar <span class="badge badge-1">29</span></span></a></clr-vertical-nav-group-children></div></clr-vertical-nav-group><div class=nav-divider></div></section></div></clr-vertical-nav><script lang=javascript>function toggleNavigation(e){var t=document.getElementById("section-"+e),n=document.getElementById("icon-"+e);t.style.display==="none"?(t.style.display="block",n.dir="down"):(t.style.display="none",n.dir="right")}</script></div><script async src="https://www.googletagmanager.com/gtag/js?id=UA-4368767-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-4368767-1")</script><script src=/js/lightbox-plus-jquery.min.js></script></clr-main-container></body></html>